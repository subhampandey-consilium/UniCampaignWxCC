(self.webpackChunkuni_connect=self.webpackChunkuni_connect||[]).push([[2534],{62534:(H,D,a)=>{"use strict";a.r(D),a.d(D,{DataExportModule:()=>Et});var w=a(93917),h=a(4859),T=a(3238),f=a(59549),y=a(97392),g=a(44144),m=a(84385),C=a(56709),v=a(8882),n=a(82689),r=a(77331),u=a(37084),i=a(27974),s=a(96308),U=a(17009),p=a(2143),A=a(3848),Z=a(28255),E=a(80529),x=a(16916),b=a(24850),t=a(94650);let R=(()=>{class e{constructor(o){this._http=o,this.API_BASE_URL=x.N.apiUrl}getAll(o,l,d="",N=""){return this._http.get(this.API_BASE_URL+"api/dataexportaudittrail",{params:(new E.LE).set("index",o.toString()).set("size",l.toString()).set("searchItem",d).set("sortBy",N)})}downloadExportFile(o){return this._http.get(this.API_BASE_URL+`api/dataexportaudittrail/download/${o}`,{observe:"response",responseType:"blob"}).pipe((0,b.U)(d=>{d.headers.get("file-name");let L=d.headers.get("content-type"),O={blob:new Blob([d.body],{type:L}),fileName:"DataExport"+(new Date).toString()+".csv"};return console.log("File download data:",O),O}))}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(E.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Y=a(79497),Q=a(23753),j=a(36787),P=a(21086),I=a(80013),J=a(75778),G=a(1059),z=a(87545),W=a(27221),K=a(94327),$=a(65938),X=a(6072),V=a(96560),S=a(1576),k=a(43764),F=a(36895);const q=["searchexportfiles"];function _(e,c){1&e&&(t.TgZ(0,"mat-header-cell",30),t._uU(1,"FileName"),t.qZA())}function tt(e,c){if(1&e&&(t.TgZ(0,"mat-cell")(1,"p",31),t._uU(2),t.qZA()()),2&e){const o=c.$implicit;t.xp6(1),t.s9C("title",o.fileName),t.xp6(1),t.hij("",o.fileName.substring(0,10),"...")}}function et(e,c){1&e&&(t.TgZ(0,"mat-header-cell",30),t._uU(1,"Source"),t.qZA())}function at(e,c){if(1&e&&(t.TgZ(0,"mat-cell")(1,"p",32),t._uU(2),t.qZA()()),2&e){const o=c.$implicit;t.xp6(2),t.Oqu(o.sourceName)}}function ot(e,c){1&e&&(t.TgZ(0,"mat-header-cell",30),t._uU(1,"List"),t.qZA())}function nt(e,c){if(1&e&&(t.TgZ(0,"mat-cell")(1,"p",32),t._uU(2),t.qZA()()),2&e){const o=c.$implicit;t.xp6(2),t.Oqu(o.listName)}}function rt(e,c){1&e&&(t.TgZ(0,"mat-header-cell",30),t._uU(1,"Campaign"),t.qZA())}function it(e,c){if(1&e&&(t.TgZ(0,"mat-cell")(1,"p",32),t._uU(2),t.qZA()()),2&e){const o=c.$implicit;t.xp6(2),t.Oqu(o.campaignName)}}function lt(e,c){1&e&&(t.TgZ(0,"mat-header-cell",30),t._uU(1,"Created On"),t.qZA())}function ct(e,c){if(1&e&&(t.TgZ(0,"mat-cell")(1,"p",32),t._uU(2),t.ALo(3,"date"),t.qZA()()),2&e){const o=c.$implicit;t.xp6(2),t.Oqu(t.xi3(3,1,o.createdOn+"Z","medium"))}}function st(e,c){1&e&&(t.TgZ(0,"mat-header-cell"),t._uU(1," Download "),t.qZA())}function dt(e,c){if(1&e){const o=t.EpF();t.TgZ(0,"mat-cell")(1,"button",33),t.NdJ("click",function(){const N=t.CHM(o).$implicit;return t.oxw().downloadExportFile(N)}),t.TgZ(2,"span",34)(3,"mat-icon"),t._uU(4,"download"),t.qZA()()()()}}function pt(e,c){1&e&&t._UZ(0,"mat-header-row")}function mt(e,c){1&e&&t._UZ(0,"mat-row",35)}function ut(e,c){1&e&&(t.TgZ(0,"div",36)(1,"span"),t._uU(2,"No Records found."),t.qZA()())}const ft=function(){return{delay:"50ms",scale:"0.2"}},M=function(e){return{value:"*",params:e}},xt=function(){return{delay:"100ms",x:"-25px"}},ht=function(){return{value:"50"}},gt=function(){return[10,25,100]};let B=(()=>{class e{constructor(o,l,d){this._dataexportService=o,this._matDialog=l,this._toastService=d,this.filteredAndPagedLists=[],this.displayedColumns=["fileName","sourceName","listName","campaignName","createdOn","download"],this.resultsLength=0}ngAfterViewInit(){let o=(0,Q.R)(this.searchexportfiles.nativeElement,"keyup").pipe((0,I.b)(800),(0,J.x)());(0,j.T)(this.sort.sortChange,this.paginator.page,o).pipe((0,G.O)({}),(0,z.w)(()=>this._dataexportService.getAll(this.paginator.pageIndex+1,this.paginator.pageSize,this.searchexportfiles.nativeElement.value,this.sort.direction)),(0,b.U)(l=>(this.resultsLength=l.result.total,l.result.items)),(0,W.K)(()=>(0,P.of)([]))).subscribe(l=>{this.filteredAndPagedLists=l,console.log("Fetched files:",this.filteredAndPagedLists)})}reload(){this._dataexportService.getAll(this.paginator.pageIndex+1,this.paginator.pageSize,this.searchexportfiles.nativeElement.value,this.sort.direction).subscribe(o=>{this.filteredAndPagedLists=o.result.items,console.log(o)})}downloadExportFile(o){this._dataexportService.downloadExportFile(o.id).subscribe(l=>{console.log(l),K.saveAs(l.blob,l.fileName),null==l&&this._toastService.success("File deleted successfully.")},l=>{console.log("Error downloading the file")})}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(R),t.Y36($.uw),t.Y36(X.k))},e.\u0275cmp=t.Xpm({type:e,selectors:[["uc-dataexport"]],viewQuery:function(o,l){if(1&o&&(t.Gf(i.NW,7),t.Gf(s.YE,7),t.Gf(p.BZ,5),t.Gf(q,7)),2&o){let d;t.iGM(d=t.CRH())&&(l.paginator=d.first),t.iGM(d=t.CRH())&&(l.sort=d.first),t.iGM(d=t.CRH())&&(l.matDataExportTable=d.first),t.iGM(d=t.CRH())&&(l.searchexportfiles=d.first)}},decls:45,vars:19,consts:[["id","dataexport",1,"page-layout","carded","fullwidth","inner-scroll"],[1,"top-bg","accent"],[1,"center"],["fxLayout","column","fxLayoutAlign","center center","fxLayout.gt-sm","row","fxLayoutAlign.gt-sm","space-between center",1,"header","accent"],["fxLayout","row","fxLayoutAlign","start center",1,"logo","mb-24","mb-md-0"],[1,"logo-icon","s-32","mr-16"],[1,"logo-text","h1"],[1,"search-wrapper","mx-32","mx-md-0"],["fxFlex","","fxLayout","row","fxLayoutAlign","start center",1,"search"],["placeholder","Search for Export Files"],["searchexportfiles",""],[1,"content-card"],["matSort","","cucPerfectScrollbar","",1,"dataexport-table",3,"dataSource"],["matDataExportTable",""],["matColumnDef","fileName"],["mat-sort-header","",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","sourceName"],["matColumnDef","listName"],["matColumnDef","campaignName"],["matColumnDef","createdOn"],["matColumnDef","download"],[4,"matHeaderCellDef"],[4,"matHeaderRowDef","matHeaderRowDefSticky"],["class","dataexport-row",4,"matRowDef","matRowDefColumns"],["class","no-data-message",4,"ngIf"],["fxLayout","row","fxLayoutAlign","end center"],["mat-icon-button","","fxLayout","column","fxLayoutAlign","center none",3,"click"],[3,"length","pageSize","pageSizeOptions"],["paginator",""],["mat-sort-header",""],[1,"text-truncate",3,"title"],[1,"text-truncate"],["color","accent","mat-icon-button","","color","accent",3,"click"],[1,"material-icons"],[1,"dataexport-row"],[1,"no-data-message"]],template:function(o,l){1&o&&(t.TgZ(0,"div",0),t._UZ(1,"div",1),t.TgZ(2,"div",2)(3,"div",3)(4,"div",4)(5,"mat-icon",5),t._uU(6," storage "),t.qZA(),t.TgZ(7,"span",6),t._uU(8," Data Export Audit Trail "),t.qZA()(),t.TgZ(9,"div",7)(10,"div",8)(11,"mat-icon"),t._uU(12,"search"),t.qZA(),t._UZ(13,"input",9,10),t.qZA()()(),t.TgZ(15,"div",11)(16,"mat-table",12,13),t.ynx(18,14),t.YNc(19,_,2,0,"mat-header-cell",15),t.YNc(20,tt,3,2,"mat-cell",16),t.BQk(),t.ynx(21,17),t.YNc(22,et,2,0,"mat-header-cell",15),t.YNc(23,at,3,1,"mat-cell",16),t.BQk(),t.ynx(24,18),t.YNc(25,ot,2,0,"mat-header-cell",15),t.YNc(26,nt,3,1,"mat-cell",16),t.BQk(),t.ynx(27,19),t.YNc(28,rt,2,0,"mat-header-cell",15),t.YNc(29,it,3,1,"mat-cell",16),t.BQk(),t.ynx(30,20),t.YNc(31,lt,2,0,"mat-header-cell",15),t.YNc(32,ct,4,4,"mat-cell",16),t.BQk(),t.ynx(33,21),t.YNc(34,st,2,0,"mat-header-cell",22),t.YNc(35,dt,5,0,"mat-cell",16),t.BQk(),t.YNc(36,pt,1,0,"mat-header-row",23),t.YNc(37,mt,1,0,"mat-row",24),t.qZA(),t.YNc(38,ut,3,0,"div",25),t.TgZ(39,"div",26)(40,"button",27),t.NdJ("click",function(){return l.reload()}),t.TgZ(41,"mat-icon"),t._uU(42,"refresh"),t.qZA()(),t._UZ(43,"mat-paginator",28,29),t.qZA()()()()),2&o&&(t.xp6(5),t.Q6J("@animate",t.VKq(12,M,t.DdM(11,ft))),t.xp6(2),t.Q6J("@animate",t.VKq(15,M,t.DdM(14,xt))),t.xp6(9),t.Q6J("dataSource",l.filteredAndPagedLists)("@animateStagger",t.DdM(17,ht)),t.xp6(20),t.Q6J("matHeaderRowDef",l.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",l.displayedColumns),t.xp6(1),t.Q6J("ngIf",0==l.filteredAndPagedLists.length),t.xp6(5),t.Q6J("length",l.resultsLength)("pageSize",10)("pageSizeOptions",t.DdM(18,gt)))},directives:[V.V,S.xw,S.Wh,y.Hw,S.yH,p.BZ,s.YE,k.i,p.w1,p.fO,p.ge,s.nU,p.Dz,p.ev,h.lW,p.as,p.XQ,p.nj,p.Gk,F.O5,i.NW],pipes:[F.uU],styles:["@media screen and (max-width: 959px){uc-dataexport #dataexport .top-bg{height:256px}}uc-dataexport #dataexport>.center>.header .search-wrapper{width:100%;max-width:480px;border-radius:28px;overflow:hidden;box-shadow:0 2px 1px -1px rgba(0,0,0,.2),0 1px 1px rgba(0,0,0,.14),0 1px 3px rgba(0,0,0,.12)}@media screen and (max-width: 599px){uc-dataexport #dataexport>.center>.header .search-wrapper{width:100%}}uc-dataexport #dataexport>.center>.header .search-wrapper .search{width:100%;height:48px;line-height:48px;padding:0 18px}uc-dataexport #dataexport>.center>.header .search-wrapper .search input{width:100%;height:48px;min-height:48px;max-height:48px;padding:0 16px;border:none;outline:none}@media screen and (max-width: 959px){uc-dataexport #dataexport>.center>.header{padding:8px 0;height:192px!important;min-height:192px!important;max-height:192px!important}}uc-dataexport .dataexport-table{flex:1 1 auto;border-bottom:1px solid rgba(0,0,0,.12);overflow:auto;-webkit-overflow-scrolling:touch}uc-dataexport .dataexport-table .mat-header-row{min-height:64px}uc-dataexport .dataexport-table .dataexport-row{position:relative;cursor:pointer;height:60px}uc-dataexport .dataexport-table .mat-cell{min-width:0;display:flex;align-items:center}uc-dataexport .dataexport-table .active-icon{border-radius:50%}uc-dataexport .no-data-message{padding-top:25px;height:100%;text-align:center}\n"],encapsulation:2,data:{animation:Y.J}}),e})();const vt=[{path:"",component:B},{path:"dataexport",component:B}];let Et=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[R],imports:[[w.Bz.forChild(vt),h.ot,r.Hi,u.To,f.lN,y.Ps,g.c,i.TU,T.si,m.LD,s.JX,U.ZX,p.p0,A.Nh,C.p9,Z.Tx,v.A,n.lJ,n.QH]]}),e})()},94327:function(H,D){var h;void 0!==(h=function(){"use strict";function f(n,r,u){var i=new XMLHttpRequest;i.open("GET",n),i.responseType="blob",i.onload=function(){v(i.response,r,u)},i.onerror=function(){console.error("could not download file")},i.send()}function y(n){var r=new XMLHttpRequest;r.open("HEAD",n,!1);try{r.send()}catch{}return 200<=r.status&&299>=r.status}function g(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(r)}}var m="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,C=m.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),v=m.saveAs||("object"!=typeof window||window!==m?function(){}:"download"in HTMLAnchorElement.prototype&&!C?function(n,r,u){var i=m.URL||m.webkitURL,s=document.createElement("a");s.download=r=r||n.name||"download",s.rel="noopener","string"==typeof n?(s.href=n,s.origin===location.origin?g(s):y(s.href)?f(n,r,u):g(s,s.target="_blank")):(s.href=i.createObjectURL(n),setTimeout(function(){i.revokeObjectURL(s.href)},4e4),setTimeout(function(){g(s)},0))}:"msSaveOrOpenBlob"in navigator?function(n,r,u){if(r=r||n.name||"download","string"!=typeof n)navigator.msSaveOrOpenBlob(function T(n,r){return typeof r>"u"?r={autoBom:!1}:"object"!=typeof r&&(console.warn("Deprecated: Expected third argument to be a object"),r={autoBom:!r}),r.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\ufeff",n],{type:n.type}):n}(n,u),r);else if(y(n))f(n,r,u);else{var i=document.createElement("a");i.href=n,i.target="_blank",setTimeout(function(){g(i)})}}:function(n,r,u,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof n)return f(n,r,u);var s="application/octet-stream"===n.type,U=/constructor/i.test(m.HTMLElement)||m.safari,p=/CriOS\/[\d]+/.test(navigator.userAgent);if((p||s&&U||C)&&typeof FileReader<"u"){var A=new FileReader;A.onloadend=function(){var x=A.result;x=p?x:x.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=x:location=x,i=null},A.readAsDataURL(n)}else{var Z=m.URL||m.webkitURL,E=Z.createObjectURL(n);i?i.location=E:location.href=E,i=null,setTimeout(function(){Z.revokeObjectURL(E)},4e4)}});m.saveAs=v.saveAs=v,H.exports=v}.apply(D,[]))&&(H.exports=h)}}]);