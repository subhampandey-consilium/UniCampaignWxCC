"use strict";(self.webpackChunkuni_connect=self.webpackChunkuni_connect||[]).push([[1735],{21735:(Aa,K,l)=>{l.r(K),l.d(K,{WhatsappCampaignManagementModule:()=>ba});var b=l(93917),A=l(4859),L=l(3238),w=l(59549),y=l(97392),q=l(44144),F=l(84385),tt=l(56709),R=l(99602),mt=l(73546),J=l(86257),ct=l(8882),et=l(82689),dt=l(77331),N=l(37084),Z=l(27974),T=l(96308),ut=l(17009),m=l(2143),Q=l(71948),I=l(3848),k=l(28255),gt=l(90782),o=l(24006),Y=l(83683),at=l(44850),x=l(65938),g=l(36895),D=l(47957),nt=l(48568),O=l(79497),ht=l(5764),_t=l(53377),it=l(74357);class H{constructor(s){this.id=(s=s||{}).id||0,this.name=s.name||"",this.description=s.description||"",this.gateway=s.gateway||"",this.timeZone=s.timeZone||new _t.S,this.country=s.country||new it.C,this.startDate=new Date(s.startDate),this.stopDate=new Date(s.stopDate),this.startTime=s.startTime||"00:00",this.stopTime=s.stopTime||"23:59",this.campaignStatus=s.campaignStatus||!1,this.maxAttempts=s.maxAttempts||1,this.batchSize=s.batchSize||10,this.timeInterval=s.timeInterval||0,this.timeUnit=s.timeUnit||""}}var v=l(1059),f=l(24850),t=l(94650),h=l(80529),st=l(16916);let U=(()=>{class a{constructor(e){this._http=e,this.API_BASE_URL=st.N.apiUrl}getAll(e,n,i="",p=""){return this._http.get(this.API_BASE_URL+"api/whatsappcampaign/getall",{params:(new h.LE).set("index",e.toString()).set("size",n.toString()).set("searchItem",i).set("sortBy",p)})}addCampaign(e){return this._http.post(this.API_BASE_URL+"api/whatsappcampaign/add",e)}changeCampaignState(e,n){return this._http.patch(this.API_BASE_URL+`api/whatsappcampaign/change-state/${e}/${n}`,null)}saveCampaign(e){return this._http.put(this.API_BASE_URL+`api/whatsappcampaign/${e.id}`,e)}deleteCampaign(e){return this._http.delete(this.API_BASE_URL+`api/whatsappcampaign/${e}`)}getById(e){return this._http.get(this.API_BASE_URL+`api/whatsappcampaign/get/${e}`)}assignWhatsappCampaignList(e){return this._http.post(this.API_BASE_URL+"api/whatsappcampaignlead/assign-lead",e)}appendLead(e,n){return this._http.get(this.API_BASE_URL+`api/whatsappcampaignlead/${e}/append`,{params:(new h.LE).set("childListId",n.toString())})}switchCampaignLeadState(e){return this._http.post(this.API_BASE_URL+"api/whatsappcampaignlead/switch-state",e)}getLeadsByCampaignId(e){return this._http.get(this.API_BASE_URL+`api/whatsappcampaignlead/${e}`)}assignCampaignHoliday(e){return this._http.post(this.API_BASE_URL+"api/campaign/assign/holiday",e)}getHolidayStats(e,n,i){return this._http.get(this.API_BASE_URL+"api/campaign/get/assignedholiday/"+e,{params:(new h.LE).set("campaignId",e.toString())})}deleteHoliday(e){return this._http.delete(this.API_BASE_URL+`api/campaign/delete/assignedholiday/${e}`)}deleteLead(e){return this._http.delete(this.API_BASE_URL+`api/whatsappcampaignlead/${e}`)}removeActiveRecords(e){return this._http.get(this.API_BASE_URL+`api/campaign/${e}/clear`)}changePriority(e,n,i){let p=this.API_BASE_URL+"api/whatsappcampaignlead/change-priority",r=new h.LE;return r=r.set("mapId",e.toString()).set("campaignId",n.toString()).set("newPriority",i.toString()),this._http.get(p,{params:r})}getLeadStatus(e,n,i){return this._http.get(this.API_BASE_URL+"api/whatsappcampaignlead/lead-status",{params:(new h.LE).set("whatsappcampaignId",e.toString())})}}return a.\u0275fac=function(e){return new(e||a)(t.LFG(h.eN))},a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var ot=l(46216),W=l(6072),pt=l(60500),E=l(96560),u=l(1576),B=l(43764);const ft=["pickerStartDateTime"],Ct=["pickerStopDateTime"];function xt(a,s){if(1&a&&(t.TgZ(0,"div",49),t._uU(1),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.hij(" ",e.whatsappcampaign.name," ")}}function wt(a,s){1&a&&(t.TgZ(0,"div",49),t._uU(1,"New Campaign"),t.qZA())}function Tt(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"button",50),t.NdJ("click",function(){return t.CHM(e),t.oxw().addWhatsappCampaign()}),t.TgZ(1,"span"),t._uU(2,"Add"),t.qZA()()}if(2&a){const e=t.oxw();t.Q6J("disabled",e.WhatsappCampaignForm.invalid)}}function Zt(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"button",50),t.NdJ("click",function(){return t.CHM(e),t.oxw().saveWhatsappCampaign()}),t.TgZ(1,"span"),t._uU(2,"Save"),t.qZA()()}if(2&a){const e=t.oxw();t.Q6J("disabled",e.WhatsappCampaignForm.invalid||e.WhatsappCampaignForm.pristine)}}function bt(a,s){if(1&a&&(t.TgZ(0,"mat-option",51),t._uU(1),t.qZA()),2&a){const e=s.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function At(a,s){if(1&a&&(t.TgZ(0,"mat-option",51),t._uU(1),t.qZA()),2&a){const e=s.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e.displayName," ")}}function yt(a,s){if(1&a&&(t.TgZ(0,"mat-option",51),t._uU(1),t.qZA()),2&a){const e=s.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e.name," ")}}const vt=function(){return{delay:"100ms",x:"-25px"}},St=function(a){return{value:"*",params:a}};let Lt=(()=>{class a{constructor(e,n,i,p,r,d,C){this._formBuilder=e,this._whatsappcampaignService=n,this._whatsappconfigurtion=i,this._router=p,this._route=r,this._snackbarService=d,this._geoInfoService=C,this.gateways=[],this.timeZoneInfos=[],this.todayDate=new Date,this.whatsappcampaign=new H,this._whatsappconfigurtion.getAll(1,200).subscribe(_=>{this.gateways=_.result.items})}ngOnInit(){this.routeParams=this._route.params,this.WhatsappCampaignForm=this.createCreateForm(),"new"===this.routeParams.value.id?(this.pageType="new",this.whatsappcampaign=new H):(this.pageType="edit",this.whatsappcampaign.id=this.routeParams.value.id,this._whatsappcampaignService.getById(this.routeParams.value.id).subscribe(e=>{this.whatsappcampaign=new ht._(e),console.log(this.whatsappcampaign),this.WhatsappCampaignForm=this.createCreateForm()})),this._geoInfoService.getAllCountries().subscribe(e=>{this.countryCodes=e.result;const n=this.countryCodes.find(i=>i.IsCurrentServerCountry);n&&this.WhatsappCampaignForm.get("country").setValue(n),this.filteredCountryCodes=this.WhatsappCampaignForm.get("country").valueChanges.pipe((0,v.O)(""),(0,f.U)(i=>"string"==typeof i?i:i.name),(0,f.U)(i=>i?this._filterCountries(i):this.countryCodes.slice()))}),this._geoInfoService.getAllTimeZones().subscribe(e=>{this.timeZoneInfos=e.result;const n=this.timeZoneInfos.find(i=>i.isCurrentServerTimeZone);this.WhatsappCampaignForm.get("timeZone").setValue(n),this.filteredTimeZoneInfos=this.WhatsappCampaignForm.get("timeZone").valueChanges.pipe((0,v.O)(""),(0,f.U)(i=>"string"==typeof i?i:i.displayName),(0,f.U)(i=>i?this._filter(i):this.timeZoneInfos.slice()))})}createCreateForm(){return this._formBuilder.group({id:[this.whatsappcampaign.id],name:new o.NI(this.whatsappcampaign.name,[o.kI.required]),description:[this.whatsappcampaign.description],gateway:new o.NI(this.whatsappcampaign.gateway,[o.kI.required]),campaignStatus:[this.whatsappcampaign.campaignStatus],maxAttempts:new o.NI(this.whatsappcampaign.maxAttempts,[o.kI.required]),batchSize:new o.NI(this.whatsappcampaign.batchSize,[o.kI.required]),country:new o.NI(this.whatsappcampaign.country,[o.kI.required]),timeZone:new o.NI(this.whatsappcampaign.timeZone,[o.kI.required]),startDate:new o.NI(this.whatsappcampaign.startDate,[o.kI.required]),stopDate:new o.NI(this.whatsappcampaign.stopDate,[o.kI.required]),startTime:new o.NI(this.whatsappcampaign.startTime,[o.kI.required]),stopTime:new o.NI(this.whatsappcampaign.stopTime,[o.kI.required]),timeInterval:new o.NI(this.whatsappcampaign.timeInterval,[o.kI.required]),timeUnit:new o.NI(this.whatsappcampaign.timeUnit,[o.kI.required])})}_filter(e){const n=e.toLowerCase();return this.timeZoneInfos.filter(i=>i.displayName.toLowerCase().includes(n))}_filterCountries(e){const n=e.toLowerCase();return this.countryCodes.filter(i=>i.name.toLowerCase().includes(n))}displayTimeZoneNameFn(e){return e&&e.displayName?e.displayName:""}displayCountryNameFn(e){return e&&e.name?e.name:void 0}addWhatsappCampaign(){const e=this.WhatsappCampaignForm.getRawValue();e.id="00000000-0000-0000-0000-000000000000",console.log(e),this._whatsappcampaignService.addCampaign(e).subscribe(n=>{n.result&&(this.whatsappcampaign.id=n.result,this._snackbarService.success(`Whatsapp Campaign ${e.name} added successfully.`),this._router.navigateByUrl("app/whatsappcampaign-management/whatsapphome"))})}saveWhatsappCampaign(){const e=this.WhatsappCampaignForm.getRawValue();e.id=this.whatsappcampaign.id,console.log(e),this._whatsappcampaignService.saveCampaign(e).subscribe(()=>{this._snackbarService.success(`Whatsapp Campaign ${e.name} added successfully.`),this._router.navigateByUrl("app/whatsappcampaign-management/whatsapphome")})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(o.qu),t.Y36(U),t.Y36(ot.p),t.Y36(b.F0),t.Y36(b.gz),t.Y36(W.k),t.Y36(pt.q))},a.\u0275cmp=t.Xpm({type:a,selectors:[["uc-whatsapp-campaign"]],viewQuery:function(e,n){if(1&e&&(t.Gf(ft,7),t.Gf(Ct,7)),2&e){let i;t.iGM(i=t.CRH())&&(n.pickerStartDateTime=i.first),t.iGM(i=t.CRH())&&(n.pickerStopDateTime=i.first)}},decls:106,vars:27,consts:[["id","smscampaign-form",1,"page-layout","carded","fullwidth","inner-scroll"],[1,"top-bg","accent"],[1,"center"],["fxLayout","row","fxLayoutAlign","space-between center",1,"header","accent"],["fxLayout","row","fxLayoutAlign","start center"],["mat-icon-button","",1,"mr-0","mr-sm-16",3,"routerLink"],["fxLayout","column","fxLayoutAlign","start start"],["class","h2",4,"ngIf"],[1,"subtitle","secondary-text"],["mat-raised-button","","class","save-product-button",3,"disabled","click",4,"ngIf"],[1,"content-card"],[1,"content"],["fxLayout","column","fxFlex","",1,"smscampaign","w-100-p",3,"formGroup"],["label","Basic Info"],["cucPerfectScrollbar","",1,"tab-content","p-24"],["appearance","outline","floatLabel","always",1,"w-100-p"],["matInput","","placeholder","Campaign Name","name","name","formControlName","name","required",""],["matInput","","placeholder","Campaign Description","name","description","formControlName","description","rows","2"],["fxLayout","row","fxLayoutAlign","space-between"],["appearance","outline","floatlabel","always","fxFlex","24"],["formControlName","gateway","required",""],[3,"value",4,"ngFor","ngForOf"],["appearance","outline","floatLabel","always","fxFlex","24"],["matInput","","type","number","placeholder","Max Attempts","name","maxAttempts","formControlName","maxAttempts","required",""],["matInput","","type","number","placeholder","Batch Size","name","batchSize","formControlName","batchSize","required",""],["labelPosition","before","formControlName","campaignStatus",1,"w-30-p"],["label","Time Settings"],["appearance","outline","floatlabel","always","fxFlex","48"],["type","text","placeholder","Select timezone","matInput","","formControlName","timeZone","required","",3,"matAutocomplete"],[3,"displayWith"],["auto","matAutocomplete"],["appearance","outline","floatLabel","always","fxFlex","48"],["type","text","placeholder","Select country","matInput","","formControlName","country","required","",3,"matAutocomplete"],["autoCountry","matAutocomplete"],["appearance","outline","fxFlex","48"],["matInput","","formControlName","startDate",3,"matDatepicker","min"],["matSuffix","",3,"for"],["color","accent"],["startDatePicker",""],["appearance","outline","fxFlex","48","floatLabel","always"],["matInput","","formControlName","stopDate",3,"matDatepicker","min"],["stopDatePicker",""],["matInput","","type","text","placeholder","00:00","name","startTime","formControlName","startTime","required",""],["matInput","","type","text","placeholder","23:59","name","stopTime","formControlName","stopTime","required",""],["matInput","","type","number","min","1","max","100","formControlName","timeInterval"],["name","timeUnit","formControlName","timeUnit","required",""],["value","Minutes"],["value","Hours"],["value","Days"],[1,"h2"],["mat-raised-button","",1,"save-product-button",3,"disabled","click"],[3,"value"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0),t._UZ(1,"div",1),t.TgZ(2,"div",2)(3,"div",3)(4,"div",4)(5,"button",5)(6,"mat-icon"),t._uU(7,"arrow_back"),t.qZA()(),t.TgZ(8,"div",6),t.YNc(9,xt,2,1,"div",7),t.YNc(10,wt,2,0,"div",7),t.TgZ(11,"div",8)(12,"span"),t._uU(13,"Campaign Settings"),t.qZA()()()(),t.YNc(14,Tt,3,1,"button",9),t.YNc(15,Zt,3,1,"button",9),t.qZA(),t.TgZ(16,"div",10)(17,"div",11)(18,"form",12)(19,"mat-tab-group")(20,"mat-tab",13)(21,"div",14)(22,"mat-form-field",15)(23,"mat-label"),t._uU(24,"Campaign Name"),t.qZA(),t._UZ(25,"input",16),t.qZA(),t.TgZ(26,"mat-form-field",15)(27,"mat-label"),t._uU(28,"Campaign Description"),t.qZA(),t.TgZ(29,"textarea",17),t._uU(30,"                                    "),t.qZA()(),t.TgZ(31,"div",18)(32,"mat-form-field",19)(33,"mat-label"),t._uU(34,"Gateway"),t.qZA(),t.TgZ(35,"mat-select",20),t.YNc(36,bt,2,2,"mat-option",21),t.qZA()(),t.TgZ(37,"mat-form-field",22)(38,"mat-label"),t._uU(39,"Max Attempts"),t.qZA(),t._UZ(40,"input",23),t.qZA(),t.TgZ(41,"mat-form-field",22)(42,"mat-label"),t._uU(43,"Batch Size"),t.qZA(),t._UZ(44,"input",24),t.qZA()(),t.TgZ(45,"div",18)(46,"mat-checkbox",25),t._uU(47," Activate Campaign "),t.qZA()()()(),t.TgZ(48,"mat-tab",26)(49,"div",14)(50,"div",18)(51,"mat-form-field",27)(52,"mat-label"),t._uU(53,"Time Zone"),t.qZA(),t._UZ(54,"input",28),t.TgZ(55,"mat-autocomplete",29,30),t.YNc(57,At,2,2,"mat-option",21),t.ALo(58,"async"),t.qZA()(),t.TgZ(59,"mat-form-field",31)(60,"mat-label"),t._uU(61,"Country"),t.qZA(),t._UZ(62,"input",32),t.TgZ(63,"mat-autocomplete",29,33),t.YNc(65,yt,2,2,"mat-option",21),t.ALo(66,"async"),t.qZA()()(),t.TgZ(67,"div",18)(68,"mat-form-field",34)(69,"mat-label"),t._uU(70,"Choose start date"),t.qZA(),t._UZ(71,"input",35)(72,"mat-datepicker-toggle",36)(73,"mat-datepicker",37,38),t.qZA(),t.TgZ(75,"mat-form-field",39)(76,"mat-label"),t._uU(77,"Choose end date"),t.qZA(),t._UZ(78,"input",40)(79,"mat-datepicker-toggle",36)(80,"mat-datepicker",37,41),t.qZA()(),t.TgZ(82,"div",18)(83,"mat-form-field",31)(84,"mat-label"),t._uU(85,"Choose start time"),t.qZA(),t._UZ(86,"input",42),t.qZA(),t.TgZ(87,"mat-form-field",31)(88,"mat-label"),t._uU(89,"Choose end time"),t.qZA(),t._UZ(90,"input",43),t.qZA()(),t.TgZ(91,"div",18)(92,"mat-form-field",31)(93,"mat-label"),t._uU(94,"Wait Time Interval"),t.qZA(),t._UZ(95,"input",44),t.qZA(),t.TgZ(96,"mat-form-field",27)(97,"mat-label"),t._uU(98,"Wait Time Unit"),t.qZA(),t.TgZ(99,"mat-select",45)(100,"mat-option",46),t._uU(101,"Minutes"),t.qZA(),t.TgZ(102,"mat-option",47),t._uU(103,"Hours"),t.qZA(),t.TgZ(104,"mat-option",48),t._uU(105,"Days"),t.qZA()()()()()()()()()()()()),2&e){const i=t.MAs(56),p=t.MAs(64),r=t.MAs(74),d=t.MAs(81);t.xp6(5),t.Q6J("routerLink","/app/whatsappcampaign-management/whatsapphome"),t.xp6(3),t.Q6J("@animate",t.VKq(25,St,t.DdM(24,vt))),t.xp6(1),t.Q6J("ngIf","edit"===n.pageType),t.xp6(1),t.Q6J("ngIf","new"===n.pageType),t.xp6(4),t.Q6J("ngIf","new"===n.pageType),t.xp6(1),t.Q6J("ngIf","edit"===n.pageType),t.xp6(3),t.Q6J("formGroup",n.WhatsappCampaignForm),t.xp6(18),t.Q6J("ngForOf",n.gateways),t.xp6(18),t.Q6J("matAutocomplete",i),t.xp6(1),t.Q6J("displayWith",n.displayTimeZoneNameFn),t.xp6(2),t.Q6J("ngForOf",t.lcZ(58,20,n.filteredTimeZoneInfos)),t.xp6(5),t.Q6J("matAutocomplete",p),t.xp6(1),t.Q6J("displayWith",n.displayCountryNameFn),t.xp6(2),t.Q6J("ngForOf",t.lcZ(66,22,n.filteredCountryCodes)),t.xp6(6),t.Q6J("matDatepicker",r)("min",n.todayDate),t.xp6(1),t.Q6J("for",r),t.xp6(6),t.Q6J("matDatepicker",d)("min",n.WhatsappCampaignForm.get("startDate").value),t.xp6(1),t.Q6J("for",d)}},directives:[E.V,u.xw,u.Wh,A.lW,b.rH,y.Hw,g.O5,o._Y,o.JL,u.yH,o.sg,I.SP,I.uX,B.i,w.KE,w.hX,q.Nt,o.Fj,o.JJ,o.u,o.Q7,F.gD,g.sg,L.ey,o.wV,tt.oG,D.ZL,D.XC,R.hl,R.nW,w.R9,R.Mq,o.qQ,o.Fd],pipes:[g.Ov],styles:["#smscampaign-form .header .subtitle{margin:6px 0 0}#smscampaign-form .content .mat-tab-group,#smscampaign-form .content .mat-tab-body-wrapper,#smscampaign-form .content .tab-content{flex:1 1 auto;max-width:100%}#smscampaign-form .content .mat-tab-body-content{display:flex}#smscampaign-form .content .mat-tab-label{height:64px}#smscampaign-form .mat-card-header-text{margin:0}\n"],encapsulation:2,data:{animation:O.J}}),a})();var Nt=l(23753),G=l(36787),$=l(21086),It=l(80013),Dt=l(75778),z=l(87545),j=l(27221),Ut=l(77394),Wt=l(88428);function Mt(a,s){1&a&&(t.TgZ(0,"mat-header-cell"),t._uU(1," List Name "),t.qZA())}function qt(a,s){if(1&a&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&a){const e=s.$implicit;t.xp6(1),t.hij(" ",e.leadName," ")}}function Ft(a,s){1&a&&(t.TgZ(0,"mat-header-cell"),t._uU(1," Total Records "),t.qZA())}function Rt(a,s){if(1&a&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&a){const e=s.$implicit;t.xp6(1),t.hij(" ",e.totalRecords," ")}}function Jt(a,s){1&a&&(t.TgZ(0,"mat-header-cell"),t._uU(1," Priority "),t.qZA())}function kt(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit;return t.oxw().changeLeadPriority(i)}),t.TgZ(1,"span",25),t._uU(2,"done"),t.qZA()()}}function Pt(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,p=t.oxw();return p.restoreChangePriorityControl(i),i.priority=p.previousPriority}),t.TgZ(1,"span",25),t._uU(2,"close"),t.qZA()()}}function Qt(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"mat-cell")(1,"div",21)(2,"input",22),t.NdJ("ngModelChange",function(i){return t.CHM(e).$implicit.priority=i}),t.qZA(),t.TgZ(3,"div",23)(4,"button",24),t.NdJ("click",function(){const p=t.CHM(e).index;return t.oxw().editPriorityClick(p)}),t.TgZ(5,"span",25),t._uU(6,"edit"),t.qZA()()(),t.YNc(7,kt,3,0,"button",26),t.YNc(8,Pt,3,0,"button",26),t.qZA()()}if(2&a){const e=s.$implicit,n=s.index,i=t.oxw();t.xp6(2),t.Q6J("disabled",!i.enablePriorityInput&&n!=i.currentRowIndex)("ngModel",e.priority),t.xp6(1),t.Q6J("hidden",i.showCancelBtnClicked&&n==i.currentRowIndex),t.xp6(4),t.Q6J("ngIf",n==i.currentRowIndex&&i.showDoneBtnClicked),t.xp6(1),t.Q6J("ngIf",n==i.currentRowIndex&&i.showCancelBtnClicked)}}function Yt(a,s){1&a&&(t.TgZ(0,"mat-header-cell"),t._uU(1," Status "),t.qZA())}function Ot(a,s){if(1&a&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&a){const e=s.$implicit;t.xp6(1),t.hij(" ",e.status," ")}}function Ht(a,s){1&a&&(t.TgZ(0,"mat-header-cell"),t._uU(1," Assigned On "),t.qZA())}function Et(a,s){if(1&a&&(t.TgZ(0,"mat-cell"),t._uU(1),t.ALo(2,"date"),t.qZA()),2&a){const e=s.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,e.assignedOn+"Z","medium")," ")}}function Bt(a,s){1&a&&(t.TgZ(0,"mat-header-cell"),t._uU(1," Actions "),t.qZA())}function Gt(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit;return t.oxw().toggleLeadStatus(i,"STOP")}),t.TgZ(1,"span",31),t._uU(2," stop_circle "),t.qZA()()}}function $t(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit;return t.oxw().toggleLeadStatus(i,"START")}),t.TgZ(1,"span",31),t._uU(2," play_circle "),t.qZA()()}}function zt(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"mat-cell"),t.YNc(1,Gt,3,0,"button",27),t.YNc(2,$t,3,0,"button",27),t.TgZ(3,"button",28),t.NdJ("click",function(){const p=t.CHM(e).$implicit;return t.oxw().goToSendDetails(p)}),t.TgZ(4,"span",25)(5,"mat-icon"),t._uU(6,"open_in_new"),t.qZA()()(),t.TgZ(7,"button",29),t.NdJ("click",function(){const p=t.CHM(e).$implicit;return t.oxw().deleteLead(p)}),t.TgZ(8,"span",25)(9,"mat-icon"),t._uU(10,"delete"),t.qZA()()()()}if(2&a){const e=s.$implicit;t.xp6(1),t.Q6J("ngIf","Stopped"!=e.status),t.xp6(1),t.Q6J("ngIf","Stopped"==e.status)}}function jt(a,s){1&a&&t._UZ(0,"mat-header-row")}function Vt(a,s){1&a&&t._UZ(0,"mat-row")}function Xt(a,s){1&a&&(t.TgZ(0,"div",32)(1,"span"),t._uU(2,"No Records found."),t.qZA()())}const Kt=function(){return[5,10,20]};let te=(()=>{class a{constructor(e,n,i){this._smscampaignService=e,this.dialogRef=n,this._snackbarService=i,this.resultsLength=0,this.localDirectoryPriorityColumns=["listName","totalRecords","totalDialed","status","assignedOn","actions"],this.displayedColumns=["listName","totalRecords","priority","status","assignedOn","actions"],this.dialStatusDataSource=[],this.enablePriorityInput=!1,this.showEditBtnClicked=!0,this.showDoneBtnClicked=!1,this.showCancelBtnClicked=!1,console.log("Routed SMSCampaign Id: ",this.whatsappcampaignId)}ngOnInit(){}ngAfterViewInit(){(0,G.T)(this.sort.sortChange,this.paginator.page).pipe((0,v.O)({}),(0,z.w)(()=>this._smscampaignService.getLeadStatus(this.whatsappcampaignId,this.paginator.pageIndex+1,this.paginator.pageSize)),(0,f.U)(e=>(this.resultsLength=e.result.total,console.log(e.result.items),e.result.items)),(0,j.K)(()=>(0,$.of)([]))).subscribe(e=>{this.dialStatusDataSource=e,console.log(e)})}reload(){this._smscampaignService.getLeadStatus(this.whatsappcampaignId,this.paginator.pageIndex+1,this.paginator.pageSize).subscribe(e=>{console.log("The Data is: "+e.result.items),this.dialStatusDataSource=e.result.items,this.restoreChangePriorityControl()})}editPriorityClick(e){this.currentRowIndex=e,this.showDoneBtnClicked=!0,this.showCancelBtnClicked=!0,this.showEditBtnClicked=!1}restoreChangePriorityControl(){this.showDoneBtnClicked=!1,this.showCancelBtnClicked=!0,this.showCancelBtnClicked=!1,this.enablePriorityInput=!1,this.currentRowIndex=null}changeLeadPriority(e){this._smscampaignService.changePriority(e.mapId,this.whatsappcampaignId,e.priority).subscribe(r=>{r&&(console.log(r),r.result?(this._snackbarService.success(r.message),this.reload()):(this._snackbarService.error(r.message),this.reload()))})}toggleLeadStatus(e,n){var i=new Wt.G;i.campaignLeadListId=e.mapId,i.action=n,this._smscampaignService.switchCampaignLeadState(i).subscribe(p=>{p.result&&("STOP"==n?(this._snackbarService.success("List stopped successfully."),this.reload()):"START"==n&&(this._snackbarService.success("List started successfully"),this.reload()))})}goToSendDetails(e){window.open("/app/whatsappcampaign-management/whatsapp-campaign-details/"+this.whatsappcampaign.id+"/"+e.mapId,"_blank")}deleteLead(e){this._smscampaignService.deleteLead(e.mapId).subscribe(n=>{console.log(n),this._snackbarService.success("Lead delete successfully."),this.reload()})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(U),t.Y36(x.so),t.Y36(W.k))},a.\u0275cmp=t.Xpm({type:a,selectors:[["uc-whatsapp-campaign-lead-status-dialog"]],viewQuery:function(e,n){if(1&e&&(t.Gf(Z.NW,7),t.Gf(T.YE,7)),2&e){let i;t.iGM(i=t.CRH())&&(n.paginator=i.first),t.iGM(i=t.CRH())&&(n.sort=i.first)}},decls:36,vars:8,consts:[[1,"top-bg","accent"],["mat-dialog-content",""],["label","Local"],["matSort","",1,"sms-campaign-lead-status-table",3,"dataSource"],["table",""],["matColumnDef","listName"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","totalRecords"],["matColumnDef","priority"],["matColumnDef","status"],["matColumnDef","assignedOn"],["matColumnDef","actions"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],["class","no-data-message",4,"ngIf"],["fxLayout","row","fxLayoutAlign","end center"],["mat-icon-button","","fxLayout","column","fxLayoutAlign","center none",3,"click"],["showFirstLastButtons","",3,"length","pageSizeOptions"],["mat-dialog-actions","","align","end"],["mat-raised-button","","color","secondary",3,"click"],[1,"container-priority-editor"],["matInput","","type","text",3,"disabled","ngModel","ngModelChange"],[3,"hidden"],["mat-icon-button","","color","accent",1,"priority-editor-btn",3,"click"],[1,"material-icons"],["class","priority-editor-btn","mat-icon-button","","color","accent",3,"click",4,"ngIf"],["mat-icon-button","","color","accent",3,"click",4,"ngIf"],["target","_blank","color","accent","mat-icon-button","","color","primary",3,"click"],["color","accent","mat-icon-button","","color","accent",3,"click"],["mat-icon-button","","color","accent",3,"click"],[1,"material-icons","btn-start-stop"],[1,"no-data-message"]],template:function(e,n){1&e&&(t.TgZ(0,"mat-toolbar",0),t._uU(1),t.qZA(),t.TgZ(2,"div",1)(3,"mat-tab-group")(4,"mat-tab",2)(5,"mat-table",3,4),t.ynx(7,5),t.YNc(8,Mt,2,0,"mat-header-cell",6),t.YNc(9,qt,2,1,"mat-cell",7),t.BQk(),t.ynx(10,8),t.YNc(11,Ft,2,0,"mat-header-cell",6),t.YNc(12,Rt,2,1,"mat-cell",7),t.BQk(),t.ynx(13,9),t.YNc(14,Jt,2,0,"mat-header-cell",6),t.YNc(15,Qt,9,5,"mat-cell",7),t.BQk(),t.ynx(16,10),t.YNc(17,Yt,2,0,"mat-header-cell",6),t.YNc(18,Ot,2,1,"mat-cell",7),t.BQk(),t.ynx(19,11),t.YNc(20,Ht,2,0,"mat-header-cell",6),t.YNc(21,Et,3,4,"mat-cell",7),t.BQk(),t.ynx(22,12),t.YNc(23,Bt,2,0,"mat-header-cell",6),t.YNc(24,zt,11,2,"mat-cell",7),t.BQk(),t.YNc(25,jt,1,0,"mat-header-row",13),t.YNc(26,Vt,1,0,"mat-row",14),t.qZA()()(),t.YNc(27,Xt,3,0,"div",15),t.TgZ(28,"div",16)(29,"button",17),t.NdJ("click",function(){return n.reload()}),t.TgZ(30,"mat-icon"),t._uU(31,"refresh"),t.qZA()(),t._UZ(32,"mat-paginator",18),t.qZA()(),t.TgZ(33,"div",19)(34,"button",20),t.NdJ("click",function(){return n.dialogRef.close(!0)}),t._uU(35,"Close"),t.qZA()()),2&e&&(t.xp6(1),t.hij("",n.whatsappcampaign.name," Lead Status"),t.xp6(4),t.Q6J("dataSource",n.dialStatusDataSource),t.xp6(20),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns),t.xp6(1),t.Q6J("ngIf",0==n.dialStatusDataSource.length),t.xp6(5),t.Q6J("length",n.resultsLength)("pageSizeOptions",t.DdM(7,Kt)))},directives:[Y.Ye,x.xY,I.SP,I.uX,m.BZ,T.YE,m.w1,m.fO,m.ge,m.Dz,m.ev,q.Nt,o.Fj,o.JJ,o.On,A.lW,g.O5,y.Hw,m.as,m.XQ,m.nj,m.Gk,u.xw,u.Wh,Z.NW,x.H8],pipes:[g.uU],styles:["mat-table[_ngcontent-%COMP%]{width:100%}mat-table[_ngcontent-%COMP%]   .a-detail[_ngcontent-%COMP%]{cursor:pointer}mat-dialog-content[_ngcontent-%COMP%]{height:400px}.no-data-message[_ngcontent-%COMP%]{padding-top:5px;text-align:center}.dialog-container-custom[_ngcontent-%COMP%]   .mat-dialog-container[_ngcontent-%COMP%]{padding:0!important}.sms-campaign-lead-status-table[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]{display:flex}.sms-campaign-lead-status-table[_ngcontent-%COMP%]   .mat-column-listName[_ngcontent-%COMP%]{flex:0 1 20%}.sms-campaign-lead-status-table[_ngcontent-%COMP%]   .mat-column-totalRecords[_ngcontent-%COMP%], .sms-campaign-lead-status-table[_ngcontent-%COMP%]   .mat-column-totalDialed[_ngcontent-%COMP%]{flex:0 1 10%;justify-content:center}.sms-campaign-lead-status-table[_ngcontent-%COMP%]   .mat-column-priority[_ngcontent-%COMP%]{flex:0 1 15%;justify-content:center}.sms-campaign-lead-status-table[_ngcontent-%COMP%]   .mat-column-status[_ngcontent-%COMP%]{flex:0 1 10%;justify-content:center}.sms-campaign-lead-status-table[_ngcontent-%COMP%]   .mat-column-assignedOn[_ngcontent-%COMP%], .sms-campaign-lead-status-table[_ngcontent-%COMP%]   .mat-column-actions[_ngcontent-%COMP%]{flex:0 1 20%}.campaign-lead-status-sf-table[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]{display:flex}.campaign-lead-status-sf-table[_ngcontent-%COMP%]   .mat-column-listName[_ngcontent-%COMP%]{flex:0 1 20%}.campaign-lead-status-sf-table[_ngcontent-%COMP%]   .mat-column-totalRecords[_ngcontent-%COMP%], .campaign-lead-status-sf-table[_ngcontent-%COMP%]   .mat-column-totalDialed[_ngcontent-%COMP%]{flex:0 1 10%;justify-content:center}.campaign-lead-status-sf-table[_ngcontent-%COMP%]   .mat-column-status[_ngcontent-%COMP%]{flex:0 1 15%;justify-content:center}.campaign-lead-status-sf-table[_ngcontent-%COMP%]   .mat-column-assignedOn[_ngcontent-%COMP%]{flex:0 1 25%}.campaign-lead-status-sf-table[_ngcontent-%COMP%]   .mat-column-actions[_ngcontent-%COMP%]{flex:0 1 10%}.btn-start-stop[_ngcontent-%COMP%]{font-size:34px}.container-priority-editor[_ngcontent-%COMP%]{border:1px solid rgba(221,218,218,.54);border-radius:5px;display:inherit;box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px rgba(0,0,0,.14),0 1px 5px rgba(0,0,0,.12)}.container-priority-editor[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:35px;min-height:inherit;text-align:center;font-size:16px;font-weight:500;vertical-align:inherit}.priority-editor-btn[_ngcontent-%COMP%]{border-radius:0 5px 5px 0;height:inherit;width:25px}"]}),a})();class ee{constructor(s){this.leadListId=(s=s||{}).campaignLeadlistId||"",this.firstName=s.firstName||"",this.whatsappTemplate=s.whatsappTemplate||"",this.templateMessage=s.templateMessage||"",this.templateImageUrl=s.templateImageUrl||"",this.uniqueIdentifier=s.uniqueIdentifier||"",this.phoneNumber=s.phoneNumber||"",this.lastName=s.lastName||"",this.recurrence=s.recurrence||P.Single,this.country=s.country||new it.C,this.sortColumns=s.sortColumns||[]}}var P=(()=>{return(a=P||(P={}))[a.Single=0]="Single",P;var a})(),S=l(68117),ae=l(12054),ne=l(63290);const ie=["stepper"];function se(a,s){1&a&&t._uU(0,"Choose action type")}function oe(a,s){1&a&&t._uU(0,"Choose list")}function pe(a,s){if(1&a&&(t.TgZ(0,"mat-option",24),t._uU(1),t.qZA()),2&a){const e=s.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function le(a,s){if(1&a&&(t.TgZ(0,"mat-option",24),t._uU(1),t.qZA()),2&a){const e=s.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij("",e.key," ")}}function re(a,s){if(1&a&&(t.TgZ(0,"mat-option",24),t._uU(1),t.qZA()),2&a){const e=s.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij("",e.key," ")}}function me(a,s){if(1&a&&(t.TgZ(0,"mat-option",24),t._uU(1),t.qZA()),2&a){const e=s.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij("",e.key," ")}}function ce(a,s){if(1&a&&(t.TgZ(0,"mat-option",24),t._uU(1),t.qZA()),2&a){const e=s.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij("",e.key," ")}}function de(a,s){if(1&a&&(t.TgZ(0,"mat-option",24),t._uU(1),t.qZA()),2&a){const e=s.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e.name," ")}}function ue(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"mat-step",4)(1,"form",14),t.YNc(2,oe,1,0,"ng-template",6),t.TgZ(3,"mat-form-field",17)(4,"mat-label"),t._uU(5,"Select Lead List"),t.qZA(),t.TgZ(6,"mat-select",18),t.NdJ("selectionChange",function(i){return t.CHM(e),t.oxw().getHeaders(i)}),t.YNc(7,pe,2,2,"mat-option",19),t.qZA()(),t.TgZ(8,"div",20)(9,"mat-form-field",21)(10,"mat-label"),t._uU(11,"Phone Number"),t.qZA(),t.TgZ(12,"mat-select",22),t.YNc(13,le,2,2,"mat-option",19),t.qZA()(),t.TgZ(14,"mat-form-field",21)(15,"mat-label"),t._uU(16,"Recurrence"),t.qZA(),t.TgZ(17,"mat-select",23)(18,"mat-option",24),t._uU(19,"Single"),t.qZA()()()(),t.TgZ(20,"div",20)(21,"mat-form-field",21)(22,"mat-label"),t._uU(23,"First Name"),t.qZA(),t.TgZ(24,"mat-select",25),t.YNc(25,re,2,2,"mat-option",19),t.qZA()(),t.TgZ(26,"mat-form-field",21)(27,"mat-label"),t._uU(28,"Last Name"),t.qZA(),t.TgZ(29,"mat-select",26),t.YNc(30,me,2,2,"mat-option",19),t.qZA()()(),t.TgZ(31,"div",20)(32,"mat-form-field",21)(33,"mat-label"),t._uU(34,"Unique Identifier"),t.qZA(),t.TgZ(35,"mat-select",27),t.YNc(36,ce,2,2,"mat-option",19),t.qZA()(),t.TgZ(37,"mat-form-field",21)(38,"mat-label"),t._uU(39,"Country"),t.qZA(),t._UZ(40,"input",28),t.TgZ(41,"mat-autocomplete",29,30),t.YNc(43,de,2,2,"mat-option",19),t.ALo(44,"async"),t.qZA()()()()()}if(2&a){const e=t.MAs(42),n=t.oxw();t.Q6J("stepControl",n.whatsappassignedListForm),t.xp6(1),t.Q6J("formGroup",n.whatsappassignedListForm),t.xp6(6),t.Q6J("ngForOf",n.ContactLists),t.xp6(6),t.Q6J("ngForOf",n.listHeaders),t.xp6(5),t.Q6J("value",0),t.xp6(7),t.Q6J("ngForOf",n.listHeaders),t.xp6(5),t.Q6J("ngForOf",n.listHeaders),t.xp6(6),t.Q6J("ngForOf",n.listHeaders),t.xp6(4),t.Q6J("matAutocomplete",e),t.xp6(1),t.Q6J("displayWith",n.displayCountryNameFn),t.xp6(2),t.Q6J("ngForOf",t.lcZ(44,11,n.filteredCountryCodes))}}function ge(a,s){1&a&&t._uU(0,"Append list")}function he(a,s){if(1&a&&(t.TgZ(0,"mat-option",24),t._uU(1),t.qZA()),2&a){const e=s.$implicit;t.Q6J("value",e.mapId),t.xp6(1),t.hij(" ",e.name," ")}}function _e(a,s){if(1&a&&(t.TgZ(0,"mat-option",24),t._uU(1),t.qZA()),2&a){const e=s.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function fe(a,s){if(1&a&&(t.TgZ(0,"mat-step"),t.YNc(1,ge,1,0,"ng-template",6),t.TgZ(2,"form",14)(3,"mat-form-field",17)(4,"mat-label"),t._uU(5,"Select Parent List"),t.qZA(),t.TgZ(6,"mat-select",31),t.YNc(7,he,2,2,"mat-option",19),t.qZA()(),t.TgZ(8,"mat-form-field",17)(9,"mat-label"),t._uU(10,"Select Child List"),t.qZA(),t.TgZ(11,"mat-select",32),t.YNc(12,_e,2,2,"mat-option",19),t.qZA()()()()),2&a){const e=t.oxw();t.xp6(2),t.Q6J("formGroup",e.smsappendLeadListForm),t.xp6(5),t.Q6J("ngForOf",e.parentContactLists),t.xp6(5),t.Q6J("ngForOf",e.contactListsToAppend)}}function Ce(a,s){1&a&&t._uU(0,"Choose Whatsapp Template")}function xe(a,s){if(1&a&&(t.TgZ(0,"mat-option",24),t._uU(1),t.qZA()),2&a){const e=s.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function we(a,s){if(1&a&&(t.TgZ(0,"mat-form-field",17)(1,"mat-label"),t._uU(2,"ImageUrl"),t.qZA(),t._UZ(3,"input",37),t._uU(4),t.qZA()),2&a){const e=t.oxw(2);t.xp6(4),t.hij(" ",e.imageUrl," ")}}function Te(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"mat-step",4)(1,"form",14),t.YNc(2,Ce,1,0,"ng-template",6),t.TgZ(3,"mat-form-field",17)(4,"mat-label"),t._uU(5,"Whatsapp Template"),t.qZA(),t.TgZ(6,"mat-select",33,34),t.NdJ("ngModelChange",function(){t.CHM(e);const i=t.MAs(7);return t.oxw().selectedmessage(i.value)}),t.YNc(8,xe,2,2,"mat-option",19),t.qZA()(),t.TgZ(9,"div")(10,"mat-form-field",17)(11,"mat-label"),t._uU(12,"Message"),t.qZA(),t._UZ(13,"input",35),t._uU(14),t.qZA()(),t.TgZ(15,"div"),t.YNc(16,we,5,1,"mat-form-field",36),t.qZA()()()}if(2&a){const e=t.oxw();t.Q6J("stepControl",e.whatsappassignedListForm),t.xp6(1),t.Q6J("formGroup",e.whatsappassignedListForm),t.xp6(7),t.Q6J("ngForOf",e.smsTemplates),t.xp6(6),t.hij(" ",e.message," "),t.xp6(2),t.Q6J("ngIf",1==e.imageEnabled)}}function Ze(a,s){1&a&&t._uU(0,"Sorting")}function be(a,s){if(1&a&&(t.TgZ(0,"mat-option",24),t._uU(1),t.qZA()),2&a){const e=s.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.key," ")}}function Ae(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"button",47),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().index;return t.oxw().addPhoneColumnFormGroup(i)}),t.TgZ(1,"mat-icon"),t._uU(2,"add"),t.qZA()()}if(2&a){const e=t.oxw().index;t.s9C("id",e)}}function ye(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"button",47),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().index;return t.oxw().removePhoneColumn(i)}),t.TgZ(1,"mat-icon"),t._uU(2,"close"),t.qZA()()}if(2&a){const e=t.oxw().index;t.s9C("id",e)}}function ve(a,s){if(1&a&&(t.TgZ(0,"div",38)(1,"div",39)(2,"mat-form-field",40)(3,"mat-label"),t._uU(4,"Header"),t.qZA(),t.TgZ(5,"mat-select",41),t.YNc(6,be,2,2,"mat-option",19),t.qZA()(),t.TgZ(7,"mat-form-field",40)(8,"mat-label"),t._uU(9,"Sort Order"),t.qZA(),t.TgZ(10,"mat-select",42)(11,"mat-option",43),t._uU(12,"Ascending"),t.qZA(),t.TgZ(13,"mat-option",44),t._uU(14,"Descending"),t.qZA()()(),t.TgZ(15,"div",45),t.YNc(16,Ae,3,1,"button",46),t.YNc(17,ye,3,1,"button",46),t.qZA()()()),2&a){const e=s.index,n=t.oxw();t.xp6(1),t.s9C("formGroupName",e),t.xp6(5),t.Q6J("ngForOf",n.listHeaders),t.xp6(10),t.Q6J("ngIf",n.sortColumnsFormArray.length-1==e),t.xp6(1),t.Q6J("ngIf",n.sortColumnsFormArray.length-1!=e)}}function Se(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div")(1,"button",48),t.NdJ("click",function(){return t.CHM(e),t.oxw().myStepper.next()}),t._uU(2,"Next"),t.qZA(),t.TgZ(3,"button",49),t.NdJ("click",function(){return t.CHM(e),t.oxw().dialogRef.close(!0)}),t._uU(4,"Close"),t.qZA()()}}function Le(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"button",53),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).appendLeadList()}),t._uU(1,"Append"),t.qZA()}if(2&a){const e=t.oxw(2);t.Q6J("disabled",!e.smsappendLeadListForm.valid)}}function Ne(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"button",54),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).myStepper.next()}),t._uU(1,"Next"),t.qZA()}}function Ie(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div")(1,"button",50),t.NdJ("click",function(){return t.CHM(e),t.oxw().myStepper.previous()}),t._uU(2,"Back"),t.qZA(),t.YNc(3,Le,2,1,"button",51),t.YNc(4,Ne,2,0,"button",52),t.TgZ(5,"button",49),t.NdJ("click",function(){return t.CHM(e),t.oxw().dialogRef.close(!0)}),t._uU(6,"Close"),t.qZA()()}if(2&a){const e=t.oxw(),n=t.MAs(4);t.xp6(3),t.Q6J("ngIf","APPEND"==e.actionSelectionForm.get("actionType").value&&1==n.selectedIndex),t.xp6(1),t.Q6J("ngIf","NEW"==e.actionSelectionForm.get("actionType").value)}}function De(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"button",53),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).assignLeadListToSMSCampaign()}),t._uU(1,"Save"),t.qZA()}if(2&a){const e=t.oxw(2);t.Q6J("disabled",!e.whatsappassignedListForm.valid)}}function Ue(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div")(1,"button",50),t.NdJ("click",function(){return t.CHM(e),t.oxw().myStepper.previous()}),t._uU(2,"Back"),t.qZA(),t.YNc(3,De,2,1,"button",51),t.TgZ(4,"button",49),t.NdJ("click",function(){return t.CHM(e),t.oxw().dialogRef.close(!0)}),t._uU(5,"Close"),t.qZA()()}if(2&a){const e=t.oxw();t.xp6(3),t.Q6J("ngIf","NEW"==e.actionSelectionForm.get("actionType").value)}}let We=(()=>{class a{constructor(e,n,i,p,r,d,C){this._formBuilder=e,this._leadlistService=n,this._smscampaignService=i,this._smstemplateService=p,this._geoInfoService=r,this._snackbarService=d,this.dialogRef=C,this.campaignLeadList={},this.listHeaders=[],this.ContactLists=[],this.parentContactLists=[],this.contactListsToAppend=[],this.leadActionType="NEW",this.smsTemplates=[],this.leadList=new ee,this._leadlistService.getAll(1,100,S.B3.Whatsapp).subscribe(_=>{this.ContactLists=_.result.items}),this._smstemplateService.getAll(1,200).subscribe(_=>{this.smsTemplates=_.result.items})}onNoClick(){this.dialogRef.close()}selectedmessage(e){this.message=this.smsTemplates.find(n=>n.id===e).message,this.imageUrl=this.smsTemplates.find(n=>n.id===e).imageUrl,this.imageEnabled=this.smsTemplates.find(n=>n.id===e).imageEnabled,this.leadList.templateMessage=this.message,this.leadList.templateImageUrl=this.imageUrl,console.log(this.message)}ngOnInit(){this.actionSelectionForm=this._formBuilder.group({actionType:["",o.kI.required]}),this.whatsappassignedListForm=this.createCreateForm(),this._geoInfoService.getAllCountries().subscribe(e=>{this.countryCodes=e.result;const n=this.countryCodes.find(i=>i.IsCurrentServerCountry);n&&this.whatsappassignedListForm.get("country").setValue(n),this.filteredCountryCodes=this.whatsappassignedListForm.get("country").valueChanges.pipe((0,v.O)(""),(0,f.U)(i=>"string"==typeof i?i:i.name),(0,f.U)(i=>i?this._filterCountries(i):this.countryCodes.slice()))})}displayCountryNameFn(e){return e&&e.name?e.name:void 0}_filterCountries(e){const n=e.toLowerCase();return this.countryCodes.filter(i=>i.name.toLowerCase().includes(n))}getHeaders(e){this._leadlistService.getLeadHeader(e.value).subscribe(n=>{this.listHeaders=n.result,console.log(this.listHeaders)})}createCreateForm(){return this._formBuilder.group({leadlistId:new o.NI(this.leadList.leadListId,[o.kI.required]),phoneNumber:new o.NI(this.leadList.phoneNumber,[o.kI.required]),firstName:[this.leadList.firstName.valueOf()],lastName:[this.leadList.lastName.valueOf()],whatsappTemplate:[this.leadList.whatsappTemplate,o.kI.required],templateMessage:this.leadList.templateMessage,templateImageUrl:this.leadList.templateImageUrl,uniqueIdentifier:[this.leadList.uniqueIdentifier.valueOf()],country:new o.NI(this.leadList.country,[o.kI.required]),recurrence:[this.leadList.recurrence],sortColumns:this.addSortColumns(this.leadList.sortColumns)})}addSortColumns(e){var n=this._formBuilder.array([]);if(0==e.length){const i=this._formBuilder.group({headerIndex:new o.NI,sortOrder:new o.NI});n.push(i)}else e.forEach(i=>{const p=this._formBuilder.group({headerIndex:new o.NI(i.sortBy),sortOrder:new o.NI(i.sortOrder)});n.push(p)});return n}addPhoneColumnFormGroup(){const e=this._formBuilder.group({headerIndex:[o.kI.required],sortOrder:[o.kI.required]});this.sortColumnsFormArray.push(e)}removePhoneColumn(e){this.sortColumnsFormArray.removeAt(this.sortColumnsFormArray.length-1)}get sortColumnsFormArray(){return this.whatsappassignedListForm.get("sortColumns")}getPhoneColumnsControls(){return this.whatsappassignedListForm.get("sortColumns").controls}rbNewListSelected(){this.whatsappassignedListForm.addControl("phoneNumber",new o.NI(this.leadList.phoneNumber,[o.kI.required])),this.whatsappassignedListForm.addControl("firstName",new o.NI(this.leadList.firstName)),this.whatsappassignedListForm.addControl("lastName",new o.NI(this.leadList.lastName)),this.whatsappassignedListForm.addControl("whatsappTemplate",new o.NI(this.leadList.whatsappTemplate)),this.whatsappassignedListForm.addControl("templateMessage",new o.NI(this.leadList.templateMessage)),this.whatsappassignedListForm.addControl("templateImageUrl",new o.NI(this.leadList.templateImageUrl)),this.whatsappassignedListForm.addControl("country",new o.NI(this.leadList.country,[o.kI.required])),this.whatsappassignedListForm.addControl("uniqueIdentifier",new o.NI(this.leadList.uniqueIdentifier)),this.whatsappassignedListForm.addControl("recurrence",new o.NI(this.leadList.recurrence)),this.whatsappassignedListForm.removeControl("childListId")}rbAppendSelected(){this._smscampaignService.getLeadsByCampaignId(this.smscampaignId).subscribe(e=>{this.parentContactLists=e.result}),this._leadlistService.getAll(1,200,S.B3.Whatsapp).subscribe(e=>{this.contactListsToAppend=e.result.items}),this.whatsappappendLeadListForm=this._formBuilder.group({parentMapId:new o.NI("",[o.kI.required]),childListId:["",[o.kI.required]]})}assignLeadListToSMSCampaign(){var e=this.whatsappassignedListForm.getRawValue();e.templateMessage=this.message,e.templateImageUrl=this.imageUrl,e.WhatsappCampaignId=this.smscampaign.id,this._smscampaignService.assignWhatsappCampaignList(e).subscribe(n=>{this._snackbarService.success("List assigned successfully."),this.dialogRef.close()})}appendLeadList(){var e=this.whatsappappendLeadListForm.getRawValue();this._smscampaignService.appendLead(e.parentMapId,e.childListId).subscribe(n=>{this._snackbarService.success("List appended successfully."),this.dialogRef.close()})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(o.qu),t.Y36(ae.Z),t.Y36(U),t.Y36(ne.q),t.Y36(pt.q),t.Y36(W.k),t.Y36(x.so))},a.\u0275cmp=t.Xpm({type:a,selectors:[["dialog-assign-lead"]],viewQuery:function(e,n){if(1&e&&t.Gf(ie,5),2&e){let i;t.iGM(i=t.CRH())&&(n.myStepper=i.first)}},decls:27,vars:14,consts:[[1,"top-bg","accent"],[1,"assign-lead-content"],[3,"disableRipple"],["stepper",""],[3,"stepControl"],[3,"formGroup"],["matStepLabel",""],[1,"choose-option"],[1,""],["formControlName","actionType",3,"ngModel","ngModelChange"],["value","NEW",3,"change"],["value","APPEND",3,"change"],[3,"stepControl",4,"ngIf"],[4,"ngIf"],[1,"form-lead-assign",3,"formGroup"],["formArrayName","sortColumns",4,"ngFor","ngForOf"],["align","end"],["appearance","outline","floatLabel","always",1,"w-100-p"],["name","leadlistId","formControlName","leadlistId",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","space-between"],["appearance","outline","floatLabel","always","fxFlex","48"],["formControlName","phoneNumber","required",""],["formControlName","recurrence"],[3,"value"],["name","firstName","formControlName","firstName"],["formControlName","lastName"],["formControlName","uniqueIdentifier"],["type","text","placeholder","Select country","matInput","","formControlName","country","required","",3,"matAutocomplete"],[3,"displayWith"],["autoCountry","matAutocomplete"],["formControlName","parentMapId"],["formControlName","childListId"],["formControlName","whatsappTemplate",3,"ngModelChange"],["templatemessage",""],["matInput","","type","textarea","name","message","formControlName","templateMessage"],["appearance","outline","floatLabel","always","class","w-100-p",4,"ngIf"],["matInput","","type","text","name","imageUrl","formControlName","templateImageUrl"],["formArrayName","sortColumns"],["fxLayout","row","fxLayoutAlign","space-between",3,"formGroupName"],["appearance","outline","floatlabel","always","fxFlex","40",1,"w-100-p"],["placeholder","Selection Required","formControlName","headerIndex"],["placeholder","Selection Required","formControlName","sortOrder"],["value","1"],["value","2"],["fxFlex","15",1,"mini-fab-button-container"],["mat-mini-fab","","color","secondary","mat-icon-button","",3,"id","click",4,"ngIf"],["mat-mini-fab","","color","secondary","mat-icon-button","",3,"id","click"],["mat-raised-button","",3,"click"],["color","primary","mat-raised-button","",3,"click"],["color","secondary","mat-raised-button","",3,"click"],["mat-raised-button","","color","accent","type","submit",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","accent",3,"click",4,"ngIf"],["mat-raised-button","","color","accent","type","submit",3,"disabled","click"],["mat-raised-button","","color","accent",3,"click"]],template:function(e,n){if(1&e&&(t.TgZ(0,"mat-toolbar",0),t._uU(1),t.qZA(),t.TgZ(2,"mat-dialog-content",1)(3,"mat-horizontal-stepper",2,3)(5,"mat-step",4)(6,"form",5),t.YNc(7,se,1,0,"ng-template",6),t.TgZ(8,"div",7)(9,"mat-label",8),t._uU(10,"Action Type :"),t.qZA(),t.TgZ(11,"mat-radio-group",9),t.NdJ("ngModelChange",function(p){return n.leadActionType=p}),t.TgZ(12,"mat-radio-button",10),t.NdJ("change",function(){return n.rbNewListSelected()}),t._uU(13,"New"),t.qZA(),t.TgZ(14,"mat-radio-button",11),t.NdJ("change",function(){return n.rbAppendSelected()}),t._uU(15,"Append"),t.qZA()()()()(),t.YNc(16,ue,45,13,"mat-step",12),t.YNc(17,fe,13,3,"mat-step",13),t.YNc(18,Te,17,5,"mat-step",12),t.TgZ(19,"mat-step",4),t.YNc(20,Ze,1,0,"ng-template",6),t.TgZ(21,"form",14),t.YNc(22,ve,18,4,"div",15),t.qZA()()()(),t.TgZ(23,"mat-dialog-actions",16),t.YNc(24,Se,5,0,"div",13),t.YNc(25,Ie,7,2,"div",13),t.YNc(26,Ue,6,1,"div",13),t.qZA()),2&e){const i=t.MAs(4);t.xp6(1),t.hij("Assign List : ",n.smscampaign.name,""),t.xp6(2),t.Q6J("disableRipple",!0),t.xp6(2),t.Q6J("stepControl",n.actionSelectionForm),t.xp6(1),t.Q6J("formGroup",n.actionSelectionForm),t.xp6(5),t.Q6J("ngModel",n.leadActionType),t.xp6(5),t.Q6J("ngIf","NEW"==n.actionSelectionForm.get("actionType").value),t.xp6(1),t.Q6J("ngIf","APPEND"==n.actionSelectionForm.get("actionType").value),t.xp6(1),t.Q6J("ngIf","NEW"==n.actionSelectionForm.get("actionType").value),t.xp6(1),t.Q6J("stepControl",n.whatsappassignedListForm),t.xp6(2),t.Q6J("formGroup",n.whatsappassignedListForm),t.xp6(1),t.Q6J("ngForOf",n.getPhoneColumnsControls()),t.xp6(2),t.Q6J("ngIf",0==i.selectedIndex),t.xp6(1),t.Q6J("ngIf",1==i.selectedIndex||2==i.selectedIndex),t.xp6(1),t.Q6J("ngIf",3==i.selectedIndex)}},directives:[Y.Ye,x.xY,J.Vq,J.C0,o._Y,o.JL,o.sg,J.VY,w.hX,Q.VQ,o.JJ,o.u,Q.U0,g.O5,w.KE,F.gD,g.sg,L.ey,u.xw,u.Wh,u.yH,o.Q7,q.Nt,o.Fj,D.ZL,D.XC,o.CE,o.x0,A.lW,y.Hw,x.H8],pipes:[g.Ov],styles:[".form-lead-assign[_ngcontent-%COMP%]{width:100%}mat-dialog-content[_ngcontent-%COMP%]{padding-top:25px}mat-radio-button[_ngcontent-%COMP%]{margin-left:15%}"]}),a})();var lt=l(55829);const Me=["searchItem"];function qe(a,s){1&a&&(t.TgZ(0,"mat-header-cell",32),t._uU(1,"Name"),t.qZA())}function Fe(a,s){if(1&a&&(t.TgZ(0,"mat-cell")(1,"p",33),t._uU(2),t.qZA()()),2&a){const e=s.$implicit;t.xp6(2),t.Oqu(e.name)}}function Re(a,s){1&a&&(t.TgZ(0,"mat-header-cell",32),t._uU(1,"Gateway"),t.qZA())}function Je(a,s){if(1&a&&(t.TgZ(0,"mat-cell")(1,"p",33),t._uU(2),t.qZA()()),2&a){const e=s.$implicit;t.xp6(2),t.Oqu(e.gateway)}}function ke(a,s){1&a&&(t.TgZ(0,"mat-header-cell",34),t._uU(1,"Status"),t.qZA())}function Pe(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"mat-cell",35)(1,"ui-switch",36),t.NdJ("change",function(i){const r=t.CHM(e).$implicit;return t.oxw().onCampaignStatusChange(i,r)})("ngModelChange",function(i){return t.CHM(e).$implicit.campaignStatus=i}),t.qZA()()}if(2&a){const e=s.$implicit;t.xp6(1),t.Q6J("ngModel",e.campaignStatus)}}function Qe(a,s){1&a&&(t.TgZ(0,"mat-header-cell"),t._uU(1,"LeadList"),t.qZA())}function Ye(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"mat-cell")(1,"a",37),t.NdJ("click",function(){const p=t.CHM(e).$implicit;return t.oxw().assignList(p)}),t._uU(2,"Assign "),t.qZA(),t._uU(3," || "),t.TgZ(4,"a",37),t.NdJ("click",function(){const p=t.CHM(e).$implicit;return t.oxw().openDialStatsDialog(p)}),t._uU(5,"View"),t.qZA()()}}function Oe(a,s){1&a&&(t.TgZ(0,"mat-header-cell"),t._uU(1,"Actions"),t.qZA())}function He(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"mat-cell")(1,"button",38),t.NdJ("click",function(i){return i.stopPropagation()}),t.TgZ(2,"mat-icon",39),t._uU(3,"more_vert"),t.qZA()(),t.TgZ(4,"mat-menu",null,40)(6,"button",41)(7,"mat-icon"),t._uU(8,"edit"),t.qZA(),t.TgZ(9,"span"),t._uU(10,"Edit"),t.qZA()(),t.TgZ(11,"button",42),t.NdJ("click",function(){const p=t.CHM(e).$implicit;return t.oxw().deleteWhatsappCampaign(p)}),t.TgZ(12,"mat-icon"),t._uU(13,"delete"),t.qZA(),t.TgZ(14,"span"),t._uU(15,"Remove"),t.qZA()()()()}if(2&a){const e=s.$implicit,n=t.MAs(5);t.xp6(1),t.Q6J("matMenuTriggerFor",n),t.xp6(5),t.Q6J("routerLink","/app/whatsappcampaign-management/whatsappcampaign/"+e.id)}}function Ee(a,s){1&a&&t._UZ(0,"mat-header-row")}function Be(a,s){1&a&&t._UZ(0,"mat-row",43)}function Ge(a,s){1&a&&(t.TgZ(0,"div",44)(1,"span"),t._uU(2,"No Records found."),t.qZA()())}const $e=function(){return{delay:"50ms",scale:"0.2"}},rt=function(a){return{value:"*",params:a}},ze=function(){return{delay:"100ms",x:"-25px"}},je=function(){return{value:"50"}},Ve=function(){return[5,10,15,30]};let V=(()=>{class a{constructor(e,n,i,p){this._whatsappcampaignService=e,this._matDialog=n,this._snackbarService=i,this._smsconfigurtion=p,this.filteredAndPagedLists=[],this.resultsLength=0,this.gateways=[],this.displayedColumns=["name","gateway","campaignStatus","assign","actions"]}ngOnInit(){this._smsconfigurtion.getAll(1,200).subscribe(e=>{this.gateways=e.result.items})}ngAfterViewInit(){let e=(0,Nt.R)(this.searchItem.nativeElement,"keyup").pipe((0,It.b)(800),(0,Dt.x)());(0,G.T)(this.sort.sortChange,this.paginator.page,e).pipe((0,v.O)({}),(0,z.w)(()=>this._whatsappcampaignService.getAll(this.paginator.pageIndex+1,this.paginator.pageSize,this.searchItem.nativeElement.value)),(0,f.U)(n=>(this.resultsLength=n.result.total,n.result.items)),(0,j.K)(()=>(0,$.of)([]))).subscribe(n=>{const p=n.map(r=>{const d=r.gateway,C=this.gateways.find(_=>_.id===d).name;return r.gateway=C,r});this.filteredAndPagedLists=p,console.log(n)})}reload(){this._whatsappcampaignService.getAll(this.paginator.pageIndex+1,this.paginator.pageSize,this.searchItem.nativeElement.value).subscribe(e=>{const i=e.result.items.map(p=>{const r=p.gateway,d=this.gateways.find(C=>C.id===r).name;return p.gateway=d,p});this.filteredAndPagedLists=i,console.log(e)})}onSelectedChange(e){console.log(e)}onCampaignStatusChange(e,n){this._whatsappcampaignService.changeCampaignState(n.id,e).subscribe(i=>{console.log("Campaign state changed:",i.result),this._snackbarService.success("Campaign state changed successfully.")})}clearActiveRecords(e){this._whatsappcampaignService.removeActiveRecords(e.id).subscribe(n=>{n.result&&this._snackbarService.success("Removed records successfully.")})}deleteWhatsappCampaign(e){this.confirmDialogRef=this._matDialog.open(Ut.J,{disableClose:!1}),this.confirmDialogRef.componentInstance.confirmMessage=`Are you sure you want to delete ${e.name} campaign?`,this.confirmDialogRef.afterClosed().subscribe(n=>{n&&(console.log(e.id),this._whatsappcampaignService.deleteCampaign(e.id).subscribe(i=>{i&&(this._snackbarService.success(`Campaign ${e.name} deleted successfully.`),this.filteredAndPagedLists.splice(this.filteredAndPagedLists.findIndex(p=>p.id==e.id),1),this.resultsLength-=1,this.matSMSCampaignTable.renderRows())})),this.confirmDialogRef=null})}assignList(e){this.assignLeadDialogRef=this._matDialog.open(We),this.assignLeadDialogRef.componentInstance.smscampaignId=e.id,this.assignLeadDialogRef.componentInstance.smscampaign=e,this.assignLeadDialogRef.afterClosed().subscribe(n=>{console.log(`Dialog result: ${n}`)})}openDialStatsDialog(e){this.dialStatsDialogRef=this._matDialog.open(te,{width:"1000px"}),this.dialStatsDialogRef.componentInstance.whatsappcampaignId=e.id,this.dialStatsDialogRef.componentInstance.whatsappcampaign=e,this.dialStatsDialogRef.afterClosed().subscribe(n=>{console.log(`Dialog result: ${n}`)})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(U),t.Y36(x.uw),t.Y36(W.k),t.Y36(ot.p))},a.\u0275cmp=t.Xpm({type:a,selectors:[["uc-whatsapp-campaign-home"]],viewQuery:function(e,n){if(1&e&&(t.Gf(Z.NW,7),t.Gf(T.YE,7),t.Gf(m.BZ,5),t.Gf(Me,7)),2&e){let i;t.iGM(i=t.CRH())&&(n.paginator=i.first),t.iGM(i=t.CRH())&&(n.sort=i.first),t.iGM(i=t.CRH())&&(n.matSMSCampaignTable=i.first),t.iGM(i=t.CRH())&&(n.searchItem=i.first)}},decls:47,vars:20,consts:[["id","smscampaign",1,"page-layout","carded","fullwidth","inner-scroll"],[1,"top-bg","accent"],[1,"center"],["fxLayout","column","fxLayoutAlign","center center","fxLayout.gt-sm","row","fxLayoutAlign.gt-sm","space-between center",1,"header","accent"],["fxLayout","row","fxLayoutAlign","start center",1,"logo","mb-24","mb-md-0"],[1,"logo-icon","s-32","mr-16"],[1,"logo-text","h1"],[1,"search-wrapper","mx-32","mx-md-0"],["fxFlex","","fxLayout","row","fxLayoutAlign","start center",1,"search"],["placeholder","Search for a smscampaign"],["searchItem",""],["mat-raised-button","",1,"cuc-white","mt-md-0",3,"routerLink"],[1,"content-card"],["matSort","","cucPerfectScrollbar","",1,"smscampaigns-table",3,"dataSource"],["matSMSCampaignTable",""],["matColumnDef","name"],["mat-sort-header","",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","gateway"],["matColumnDef","campaignStatus"],["mat-sort-header","","fxHide","","fxShow.gt-xs","",4,"matHeaderCellDef"],["fxHide","","fxShow.gt-xs","",4,"matCellDef"],["matColumnDef","assign"],[4,"matHeaderCellDef"],["matColumnDef","actions"],[4,"matHeaderRowDef","matHeaderRowDefSticky"],["class","camapign",4,"matRowDef","matRowDefColumns"],["class","no-data-message",4,"ngIf"],["fxLayout","row","fxLayoutAlign","end center"],["mat-icon-button","","fxLayout","column","fxLayoutAlign","center center",3,"click"],[3,"length","pageSize","pageSizeOptions"],["paginator",""],["mat-sort-header",""],[1,"text-truncate"],["mat-sort-header","","fxHide","","fxShow.gt-xs",""],["fxHide","","fxShow.gt-xs",""],["switchColor","accent","size","large",3,"ngModel","change","ngModelChange"],[3,"click"],["mat-icon-button","","aria-label","More",3,"matMenuTriggerFor","click"],[1,"secondary-text"],["moreMenu","matMenu"],["mat-menu-item","","aria-label","edit",3,"routerLink"],["mat-menu-item","","aria-label","remove",3,"click"],[1,"camapign"],[1,"no-data-message"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t._UZ(1,"div",1),t.TgZ(2,"div",2)(3,"div",3)(4,"div",4)(5,"mat-icon",5),t._uU(6," sms "),t.qZA(),t.TgZ(7,"span",6),t._uU(8," WhatsApp Campaign Management "),t.qZA()(),t.TgZ(9,"div",7)(10,"div",8)(11,"mat-icon"),t._uU(12,"search"),t.qZA(),t._UZ(13,"input",9,10),t.qZA()(),t.TgZ(15,"button",11)(16,"mat-icon"),t._uU(17,"add"),t.qZA(),t.TgZ(18,"span"),t._uU(19,"Add New Campaign"),t.qZA()()(),t.TgZ(20,"div",12)(21,"mat-table",13,14),t.ynx(23,15),t.YNc(24,qe,2,0,"mat-header-cell",16),t.YNc(25,Fe,3,1,"mat-cell",17),t.BQk(),t.ynx(26,18),t.YNc(27,Re,2,0,"mat-header-cell",16),t.YNc(28,Je,3,1,"mat-cell",17),t.BQk(),t.ynx(29,19),t.YNc(30,ke,2,0,"mat-header-cell",20),t.YNc(31,Pe,2,1,"mat-cell",21),t.BQk(),t.ynx(32,22),t.YNc(33,Qe,2,0,"mat-header-cell",23),t.YNc(34,Ye,6,0,"mat-cell",17),t.BQk(),t.ynx(35,24),t.YNc(36,Oe,2,0,"mat-header-cell",23),t.YNc(37,He,16,2,"mat-cell",17),t.BQk(),t.YNc(38,Ee,1,0,"mat-header-row",25),t.YNc(39,Be,1,0,"mat-row",26),t.qZA(),t.YNc(40,Ge,3,0,"div",27),t.TgZ(41,"div",28)(42,"button",29),t.NdJ("click",function(){return n.reload()}),t.TgZ(43,"mat-icon"),t._uU(44,"refresh"),t.qZA()(),t._UZ(45,"mat-paginator",30,31),t.qZA()()()()),2&e&&(t.xp6(5),t.Q6J("@animate",t.VKq(13,rt,t.DdM(12,$e))),t.xp6(2),t.Q6J("@animate",t.VKq(16,rt,t.DdM(15,ze))),t.xp6(8),t.Q6J("routerLink","/app/whatsappcampaign-management/whatsappcampaign/new"),t.xp6(6),t.Q6J("dataSource",n.filteredAndPagedLists)("@animateStagger",t.DdM(18,je)),t.xp6(17),t.Q6J("matHeaderRowDef",n.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns),t.xp6(1),t.Q6J("ngIf",0==n.filteredAndPagedLists.length),t.xp6(5),t.Q6J("length",n.resultsLength)("pageSize",5)("pageSizeOptions",t.DdM(19,Ve)))},directives:[E.V,u.xw,u.Wh,y.Hw,u.yH,A.lW,b.rH,m.BZ,T.YE,B.i,m.w1,m.fO,m.ge,T.nU,m.Dz,m.ev,lt.b8,nt.o,o.JJ,o.On,k.p6,k.VK,k.OP,m.as,m.XQ,m.nj,m.Gk,g.O5,Z.NW],styles:["@media screen and (max-width: 959px){uc-whatsapp-campaign-home #smscampaign .top-bg{height:256px}}uc-whatsapp-campaign-home #smscampaign>.center>.header .search-wrapper{width:100%;max-width:470px;border-radius:28px;overflow:hidden;box-shadow:0 2px 1px -1px rgba(0,0,0,.2),0 1px 1px rgba(0,0,0,.14),0 1px 3px rgba(0,0,0,.12)}@media screen and (max-width: 599px){uc-whatsapp-campaign-home #smscampaign>.center>.header .search-wrapper{width:100%}}uc-whatsapp-campaign-home #smscampaign>.center>.header .search-wrapper .search{width:95%;height:48px;line-height:48px;padding:0 18px}uc-whatsapp-campaign-home #smscampaign>.center>.header .search-wrapper .search input{width:100%;height:48px;min-height:48px;max-height:48px;padding:0 16px;border:none;outline:none}@media screen and (max-width: 959px){uc-whatsapp-campaign-home #smscampaign>.center>.header{padding:8px 0;height:192px!important;min-height:192px!important;max-height:192px!important}}uc-whatsapp-campaign-home .smscampaigns-table{flex:1 1 auto;border-bottom:1px solid rgba(0,0,0,.12);overflow:auto;-webkit-overflow-scrolling:touch}uc-whatsapp-campaign-home .smscampaigns-table .mat-header-row{min-height:64px}uc-whatsapp-campaign-home .smscampaigns-table .smscamapign{position:relative;height:60px}uc-whatsapp-campaign-home .smscampaigns-table .mat-cell{min-width:0;display:flex;align-items:center}uc-whatsapp-campaign-home .smscampaigns-table .mat-cell a{cursor:pointer}uc-whatsapp-campaign-home .smscampaigns-table .active-icon{border-radius:50%}uc-whatsapp-campaign-home .no-data-message{padding-top:5px;text-align:center}\n"],encapsulation:2,data:{animation:O.J}}),a})();var Xe=l(94327);let Ke=(()=>{class a{constructor(e){this._http=e,this.API_BASE_URL=st.N.apiUrl}whatsappDetails(e,n,i=null,p=null,r,d,C=1,_=10,X=""){let M=this.API_BASE_URL+"api/whatsapp-details",c=new h.LE;return c=c.set("whatsappcampaignId",e.toString()).set("mapId",n.toString()),i&&(c=c.set("recordStatus",i)),p&&(c=c.set("recordResult",p)),X&&(c=c.set("search",X)),r&&(c=c.set("sortBy",r)),c=c.set("sortDir","desc"==d?S.fe.DESC.toString():S.fe.ASC.toString()),c=c.set("index",C.toString()).set("size",_.toString()),console.log(M,c),this._http.get(M,{params:c})}changePriority(e,n,i){let p=this.API_BASE_URL+"api/campaignlead/change-priority",r=new h.LE;return r=r.set("mapId",e.toString()).set("campaignId",n.toString()).set("newPriority",i.toString()),this._http.get(p,{params:r})}getLeadStats(e,n,i){return this._http.get(this.API_BASE_URL+"api/campaignlead/lead-stats",{params:(new h.LE).set("campaignId",e.toString())})}getLeadStatsSF(e,n,i){return this._http.get(this.API_BASE_URL+"api/campaignlead/lead-stats-salesforce",{params:(new h.LE).set("campaignId",e.toString())})}downloadDialerReport(e,n=null,i=null){let p=this.API_BASE_URL+"api/dialer-details/download",r=new h.LE;return r=r.set("mapId",e.toString()),n&&(r=r.set("recordStatus",n)),i&&(r=r.set("recordResut",i)),this._http.get(p,{observe:"response",responseType:"blob",params:r}).pipe((0,f.U)(d=>{d.headers.get("file-name");let _=d.headers.get("content-type"),M={blob:new Blob([d.body],{type:_}),fileName:"dialer_detail"+(new Date).toString()+".csv"};return console.log("File download data:",M),M}))}}return a.\u0275fac=function(e){return new(e||a)(t.LFG(h.eN))},a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var ta=l(17622),ea=l(40368);const aa=["filter"],na=["input"];function ia(a,s){if(1&a&&(t.TgZ(0,"mat-option",32),t._uU(1),t.qZA()),2&a){const e=s.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.text,"")}}function sa(a,s){if(1&a&&(t.TgZ(0,"mat-option",32),t._uU(1),t.qZA()),2&a){const e=s.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.text,"")}}function oa(a,s){1&a&&(t.TgZ(0,"mat-header-cell"),t._uU(1,"Phone Number"),t.qZA())}function pa(a,s){if(1&a&&(t.TgZ(0,"mat-cell")(1,"p",33),t._uU(2),t.qZA()()),2&a){const e=s.$implicit;t.xp6(2),t.Oqu(e.phoneNumber)}}function la(a,s){1&a&&(t.TgZ(0,"mat-header-cell"),t._uU(1," Name"),t.qZA())}function ra(a,s){if(1&a&&(t.TgZ(0,"mat-cell")(1,"p",33),t._uU(2),t.qZA()()),2&a){const e=s.$implicit;t.xp6(2),t.AsE("",e.firstName," ",e.lastName,"")}}function ma(a,s){1&a&&(t.TgZ(0,"mat-header-cell",34),t._uU(1,"Whatsapp Status"),t.qZA())}function ca(a,s){if(1&a&&(t.TgZ(0,"mat-cell")(1,"p",33),t._uU(2),t.qZA()()),2&a){const e=s.$implicit;t.xp6(2),t.Oqu(e.whatsappStatus)}}function da(a,s){1&a&&(t.TgZ(0,"mat-header-cell",34),t._uU(1,"Whatsapp Result"),t.qZA())}function ua(a,s){if(1&a&&(t.TgZ(0,"mat-cell")(1,"p",33),t._uU(2),t.qZA()()),2&a){const e=s.$implicit;t.xp6(2),t.Oqu(e.whatsappResult)}}function ga(a,s){1&a&&(t.TgZ(0,"mat-header-cell"),t._uU(1," Imported DateTime "),t.qZA())}function ha(a,s){if(1&a&&(t.TgZ(0,"mat-cell"),t._uU(1),t.ALo(2,"date"),t.qZA()),2&a){const e=s.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,e.importedDateTime+"Z","medium")," ")}}function _a(a,s){1&a&&(t.TgZ(0,"mat-header-cell"),t._uU(1," Processed On "),t.qZA())}function fa(a,s){if(1&a&&(t.TgZ(0,"mat-cell"),t._uU(1),t.ALo(2,"date"),t.qZA()),2&a){const e=s.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,e.processedOn+"Z","medium")," ")}}function Ca(a,s){1&a&&t._UZ(0,"mat-header-row")}function xa(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"mat-row",35),t.NdJ("click",function(){const p=t.CHM(e).$implicit;return t.oxw().toggleRow(p)}),t.qZA()}}const wa=function(){return{value:"50"}},Ta=function(){return[5,10,25,50]},Za=[{path:"",component:V},{path:"whatsapphome",component:V},{path:"whatsappcampaign",component:V},{path:"whatsappcampaign/:id",component:Lt},{path:"whatsapp-campaign-details/:whatsappcampaignId/:mapId",component:(()=>{class a{constructor(e,n,i,p,r){this._smsDetailsService=e,this._activatedRoute=n,this._matDialog=i,this._cucConfigService=p,this._toastService=r,this.recordStatuses=S.rf,this.recordResults=S.$O,this.filteredAndPagedLists=[],this.resultsLength=0,this.isFilterAreaVisible=!1,this.displayedColumns=["name","phoneNumber","whatsappStatus","whatsappResult","importedDateTime","processedOn"],this.listName="",this.routeParams=this._activatedRoute.params,this.smscampaign=new H,this._cucConfigService.config={layout:{navbar:{hidden:!1,folded:!0},toolbar:{hidden:!1},footer:{hidden:!1},sidepanel:{hidden:!0}}}}ngOnInit(){this.whatsappcampaignId=this.routeParams.value.whatsappcampaignId,this.mapId=this.routeParams.value.mapId,this.filterApplyForm=new o.cw({recordStatus:new o.NI(""),recordResult:new o.NI("")})}ngAfterViewInit(){(0,G.T)(this.sort.sortChange,this.paginator.page).pipe((0,v.O)({}),(0,z.w)(()=>(console.log(this.routeParams),this._smsDetailsService.whatsappDetails(this.routeParams.value.whatsappcampaignId,this.routeParams.value.mapId,this.selectedRecordStatus,this.selectedRecordResult,this.sort.active,this.sort.direction,this.paginator.pageIndex+1,this.paginator.pageSize))),(0,f.U)(e=>(console.log(e),e)),(0,j.K)(()=>(0,$.of)([]))).subscribe(e=>{e.result&&(this.resultsLength=e.result.total,this.filteredAndPagedLists=e.result.items,this.listName=e.result.items[0].listName),console.log(e)})}submitFiltersForm(){this._smsDetailsService.whatsappDetails(this.whatsappcampaignId,this.mapId,this.selectedRecordStatus,this.selectedRecordResult,this.sort.active,this.sort.direction,this.paginator.pageIndex+1,this.paginator.pageSize).subscribe(e=>{e.result&&(this.resultsLength=e.result.total,this.filteredAndPagedLists=e.result.items)})}resetFiltersForm(){this.selectedRecordStatus=null,this.selectedRecordResult=null,this.submitFiltersForm(),this.filterApplyForm.reset()}disableApplyButton(e,n,i){return null==e&&null==e&&null==n&&null==n&&null==i&&null==i}disableRechurnButton(e,n){return!(null!=e&&null!=e||null!=n&&null!=n)}recordStatusSelectionChange(e){console.log(e)}recordResultSelectionChange(e){console.log(e)}toggleRow(e){0!=e.whatsappResults.length&&(this.currentExpandedRow=this.currentExpandedRow===e?null:e)}isExpandedRow(e){return this.currentExpandedRow&&e.dialerId==this.currentExpandedRow.dialerId}downloadReport(){this._smsDetailsService.downloadDialerReport(this.routeParams.value.mapId,this.selectedRecordStatus,this.selectedRecordResult).subscribe(p=>{console.log(p),Xe.saveAs(p.blob,p.fileName)},p=>{console.log("Error downloading the file")})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(Ke),t.Y36(b.gz),t.Y36(x.uw),t.Y36(ta.F),t.Y36(W.k))},a.\u0275cmp=t.Xpm({type:a,selectors:[["uc-whatsapp-campaign-details"]],viewQuery:function(e,n){if(1&e&&(t.Gf(Z.NW,7),t.Gf(T.YE,7),t.Gf(aa,7),t.Gf(na,7),t.Gf(m.BZ,5)),2&e){let i;t.iGM(i=t.CRH())&&(n.paginator=i.first),t.iGM(i=t.CRH())&&(n.sort=i.first),t.iGM(i=t.CRH())&&(n.filter=i.first),t.iGM(i=t.CRH())&&(n.input=i.first),t.iGM(i=t.CRH())&&(n.matSendDetailsTable=i.first)}},decls:60,vars:21,consts:[["id","sms-campaign-details",1,"page-layout","carded","fullwidth","inner-scroll"],[1,"center"],[1,"send-detail-header"],["hideToggle",""],[2,"display","contents"],["fxLayout","row","fxLayoutGap","20px",1,"form-lead-assign",3,"formGroup"],["appearance","outline","floatlabel","always",1,"w-30-p"],["name","type","formControlName","recordStatus",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","type","formControlName","recordResult",3,"ngModel","ngModelChange"],["fxLayout","row","fxLayoutGap","20px"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","secondary",3,"click"],["mat-flat-button","","color","accent",3,"click"],[1,"content-card"],["multiTemplateDataRows","","matSort","","cucPerfectScrollbar","",1,"send-details-table",3,"dataSource"],["table",""],["matColumnDef","phoneNumber"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","name"],["matColumnDef","whatsappStatus"],["fxHide","","fxShow.gt-xs","",4,"matHeaderCellDef"],["matColumnDef","whatsappResult"],["matColumnDef","importedDateTime"],["matColumnDef","processedOn"],[4,"matHeaderRowDef","matHeaderRowDefSticky"],["class","sms-record","matRipple","",3,"click",4,"matRowDef","matRowDefColumns"],["fxLayout","row","fxLayoutAlign","end center"],["mat-icon-button","","fxLayout","column","fxLayoutAlign","center none",3,"click"],[3,"length","pageIndex","pageSize","pageSizeOptions"],["paginator",""],[3,"value"],[1,"text-truncate"],["fxHide","","fxShow.gt-xs",""],["matRipple","",1,"sms-record",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"mat-expansion-panel",3)(4,"mat-expansion-panel-header")(5,"mat-panel-title"),t._uU(6," Filters "),t.qZA(),t.TgZ(7,"mat-panel-description",4)(8,"mat-icon"),t._uU(9,"filter_list"),t.qZA()()(),t.TgZ(10,"form",5)(11,"mat-form-field",6)(12,"mat-label"),t._uU(13,"Record Status"),t.qZA(),t.TgZ(14,"mat-select",7),t.NdJ("ngModelChange",function(p){return n.selectedRecordStatus=p})("ngModelChange",function(){return n.recordStatusSelectionChange(n.selectedRecordStatus)}),t.YNc(15,ia,2,2,"mat-option",8),t.ALo(16,"enumToArrayPipe"),t.qZA()(),t.TgZ(17,"mat-form-field",6)(18,"mat-label"),t._uU(19,"Call Result"),t.qZA(),t.TgZ(20,"mat-select",9),t.NdJ("ngModelChange",function(p){return n.selectedRecordResult=p})("ngModelChange",function(){return n.recordResultSelectionChange(n.selectedRecordResult)}),t.YNc(21,sa,2,2,"mat-option",8),t.ALo(22,"enumToArrayPipe"),t.qZA()()(),t.TgZ(23,"div",10)(24,"button",11),t.NdJ("click",function(){return n.submitFiltersForm()}),t._uU(25," Apply "),t.qZA(),t.TgZ(26,"button",12),t.NdJ("click",function(){return n.resetFiltersForm()}),t._uU(27," Reset "),t.qZA(),t.TgZ(28,"button",13),t.NdJ("click",function(){return n.downloadReport()}),t._uU(29," Download "),t.qZA()()()(),t.TgZ(30,"div",14),t._UZ(31,"mat-divider"),t.TgZ(32,"mat-table",15,16),t.ynx(34,17),t.YNc(35,oa,2,0,"mat-header-cell",18),t.YNc(36,pa,3,1,"mat-cell",19),t.BQk(),t.ynx(37,20),t.YNc(38,la,2,0,"mat-header-cell",18),t.YNc(39,ra,3,2,"mat-cell",19),t.BQk(),t.ynx(40,21),t.YNc(41,ma,2,0,"mat-header-cell",22),t.YNc(42,ca,3,1,"mat-cell",19),t.BQk(),t.ynx(43,23),t.YNc(44,da,2,0,"mat-header-cell",22),t.YNc(45,ua,3,1,"mat-cell",19),t.BQk(),t.ynx(46,24),t.YNc(47,ga,2,0,"mat-header-cell",18),t.YNc(48,ha,3,4,"mat-cell",19),t.BQk(),t.ynx(49,25),t.YNc(50,_a,2,0,"mat-header-cell",18),t.YNc(51,fa,3,4,"mat-cell",19),t.BQk(),t.YNc(52,Ca,1,0,"mat-header-row",26),t.YNc(53,xa,1,0,"mat-row",27),t.qZA(),t.TgZ(54,"div",28)(55,"button",29),t.NdJ("click",function(){return n.submitFiltersForm()}),t.TgZ(56,"mat-icon"),t._uU(57,"refresh"),t.qZA()(),t._UZ(58,"mat-paginator",30,31),t.qZA()()()()),2&e&&(t.xp6(10),t.Q6J("formGroup",n.filterApplyForm)("formGroup",n.filterApplyForm),t.xp6(4),t.Q6J("ngModel",n.selectedRecordStatus),t.xp6(1),t.Q6J("ngForOf",t.lcZ(16,15,n.recordStatuses)),t.xp6(5),t.Q6J("ngModel",n.selectedRecordResult),t.xp6(1),t.Q6J("ngForOf",t.lcZ(22,17,n.recordResults)),t.xp6(11),t.Q6J("dataSource",n.filteredAndPagedLists)("@animateStagger",t.DdM(19,wa)),t.xp6(20),t.Q6J("matHeaderRowDef",n.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns),t.xp6(5),t.Q6J("length",n.resultsLength)("pageIndex",0)("pageSize",10)("pageSizeOptions",t.DdM(20,Ta)))},directives:[E.V,N.ib,N.yz,N.yK,N.u4,y.Hw,o._Y,o.JL,u.xw,u.SQ,o.sg,w.KE,w.hX,F.gD,o.JJ,o.u,g.sg,L.ey,A.lW,at.d,m.BZ,T.YE,B.i,m.w1,m.fO,m.ge,m.Dz,m.ev,lt.b8,m.as,m.XQ,m.nj,m.Gk,L.wG,u.Wh,Z.NW],pipes:[ea.T,g.uU],styles:["@media screen and (max-width: 959px){uc-whatsapp-campaign-details #smscampaign-details .top-bg{height:256px}}uc-whatsapp-campaign-details #smscampaign-details>.center>.header .search-wrapper{width:100%;max-width:480px;border-radius:28px;overflow:hidden;text-align:center!important;margin-left:30%!important;margin-top:40px;box-shadow:0 2px 1px -1px rgba(0,0,0,.2),0 1px 1px rgba(0,0,0,.14),0 1px 3px rgba(0,0,0,.12)}@media screen and (max-width: 599px){uc-whatsapp-campaign-details #smscampaign-details>.center>.header .search-wrapper{width:100%}}uc-whatsapp-campaign-details #smscampaign-details>.center>.header .search-wrapper .search{width:100%;height:48px;line-height:48px;padding:0 18px}uc-whatsapp-campaign-details #smscampaign-details>.center>.header .search-wrapper .search input{width:100%;height:48px;min-height:48px;max-height:48px;padding:0 16px;border:none;outline:none}@media screen and (max-width: 959px){uc-whatsapp-campaign-details #smscampaign-details>.center>.header{padding:8px 0;height:192px!important;min-height:0px!important;max-height:192px!important}}uc-whatsapp-campaign-details .send-detail-header{margin-top:10px;margin-bottom:10px}uc-whatsapp-campaign-details .example-headers-align .mat-form-field+.mat-form-field{margin-left:8px}uc-whatsapp-campaign-details .send-details-table{flex:1 1 auto;border-bottom:1px solid rgba(0,0,0,.12);overflow:auto;-webkit-overflow-scrolling:touch}uc-whatsapp-campaign-details .send-details-table .mat-header-row{min-height:64px}uc-whatsapp-campaign-details .send-details-table .sms-record{position:relative;cursor:pointer;height:50px}uc-whatsapp-campaign-details .send-details-table .mat-cell{min-width:0;display:flex;align-items:center}uc-whatsapp-campaign-details .send-details-table .mat-column-phoneNumber{flex:0 1 10%}uc-whatsapp-campaign-details .send-details-table .mat-column-name{flex:0 1 15%}uc-whatsapp-campaign-details .send-details-table .mat-column-dialDateTime{flex:0 1 15%}uc-whatsapp-campaign-details .send-details-table .mat-column-attemptedDialWindow{flex:0 1 15%}uc-whatsapp-campaign-details .send-details-table .mat-column-smsStatus{flex:0 1 15%}uc-whatsapp-campaign-details .send-details-table .mat-column-smsResult{flex:0 1 15%}uc-whatsapp-campaign-details .send-details-table .active-icon{border-radius:50%}uc-whatsapp-campaign-details .spacer{flex:1 1 auto}uc-whatsapp-campaign-details .example-detail-row{height:0;min-height:auto;display:none;width:100%}uc-whatsapp-campaign-details .display-expanded-row{display:inline-block;height:auto}\n"],encapsulation:2,data:{animation:O.J}}),a})()}];let ba=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({providers:[U],imports:[[o.u5,g.ez,b.Bz.forChild(Za),J.T5,nt.S,D.Bb,gt.N6,A.ot,dt.Hi,at.t,N.To,w.lN,y.Ps,q.c,Z.TU,L.si,F.LD,T.JX,ut.ZX,m.p0,I.Nh,tt.p9,k.Tx,R.FA,Y.g0,mt.QW,x.Is,Q.Fk,ct.A,et.lJ,et.QH]]}),a})()}}]);